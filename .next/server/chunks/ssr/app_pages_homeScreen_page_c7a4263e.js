module.exports=[19445,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944);a.i(30485);var e=a.i(31052),f=a.i(76650);a.i(69387);var g=a.i(60574),h=a.i(84496),i=a.i(80858),j=a.i(10682);let k=({project:a})=>{let{t:c,language:e}=(0,j.useStrings)(),f=(0,d.useRouter)(),g=a=>{if(!a)return"";try{return new Date(a).toLocaleDateString((()=>{switch(e){case"ru":return"ru-RU";case"en":default:return"en-GB";case"uz":return"uz-UZ"}})(),{day:"2-digit",month:"2-digit",year:"numeric"})}catch(b){return a}};return(0,b.jsx)("div",{onClick:()=>f.push(`/pages/projects/${a.id}`),className:`p-6 rounded-lg border-2 ${(a=>{switch(a?.toLowerCase()){case"active":return"border-black ";case"completed":return"border-green-400 ";case"upcoming":return"border-yellow-400 ";default:return"border-gray-300 "}})(a.status)} bg-white shadow-sm hover:shadow-md transition-shadow duration-200 cursor-pointer hover:border-blue-400`,children:(0,b.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,b.jsx)("h3",{className:"text-xl font-semibold text-gray-800",children:a.title}),a.description&&(0,b.jsx)("p",{className:"text-sm text-gray-600 line-clamp-2",children:a.description}),(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[(0,b.jsx)("span",{children:g(a.startDate)}),(0,b.jsx)("span",{children:"-"}),(0,b.jsx)("span",{children:g(a.endDate)})]}),a.ownerName&&(0,b.jsxs)("div",{className:"mt-2 text-sm text-gray-600",children:[(0,b.jsxs)("span",{className:"font-medium",children:[c("projects.owner"),":"]})," ",a.ownerName]}),a.participantsNames&&a.participantsNames.length>0&&(0,b.jsxs)("div",{className:"mt-2 text-sm text-gray-600",children:[(0,b.jsxs)("span",{className:"font-medium",children:[c("projects.team"),":"]})," ",a.participantsNames.join(", ")]}),(0,b.jsx)("div",{className:"mt-2",children:(0,b.jsx)("span",{className:`px-3 py-1 rounded-full text-xs font-medium
                        ${a.status?.toLowerCase()==="active"?"bg-blue-100 text-blue-800":a.status?.toLowerCase()==="completed"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:a.status||c("meetings.noStatus")})})]})})},l=({meeting:a})=>{let{t:c,language:d}=(0,j.useStrings)(),e=()=>{switch(d){case"ru":return"ru-RU";case"en":default:return"en-GB";case"uz":return"uz-UZ"}},{datetime:f,time:g}=(a=>{if(!a)return"";try{let b=new Date(a);return{datetime:b.toLocaleDateString(e(),{day:"2-digit",month:"2-digit",year:"numeric"}),time:b.toLocaleTimeString(e(),{hour:"2-digit",minute:"2-digit"})}}catch(a){return{datetime:"",time:""}}})(a.datetime);return(0,b.jsxs)("div",{className:"bg-white rounded-lg shadow-sm hover:shadow-md transition-shadow duration-200 p-6 border border-gray-200",children:[(0,b.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-xl font-semibold text-gray-800 mb-1",children:a.title}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:"text-sm text-gray-600",children:f}),(0,b.jsx)("span",{className:"text-sm font-semibold text-blue-600",children:g})]})]}),(0,b.jsx)("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${(a=>{switch(a?.toLowerCase()){case"scheduled":return"bg-blue-100  text-blue-800 ";case"completed":return"bg-green-100  text-green-800 ";case"cancelled":return"bg-red-100  text-red-800 ";default:return"bg-gray-100  text-gray-800 "}})(a.status)}`,children:a.status||c("meetings.noStatus")})]}),a.location&&(0,b.jsxs)("div",{className:"mb-3 flex items-center gap-2",children:[(0,b.jsxs)("svg",{className:"w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),(0,b.jsx)("span",{className:"text-sm text-gray-600",children:a.location})]}),a.owner&&(0,b.jsxs)("div",{className:"mb-3 text-sm text-gray-600",children:[(0,b.jsxs)("span",{className:"font-medium",children:[c("meetings.organizer"),":"]})," ",a.ownerName||a.owner]}),a.participants&&a.participants.length>0&&(0,b.jsxs)("div",{className:"mb-3",children:[(0,b.jsxs)("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:[c("meetings.participants"),":"]}),(0,b.jsx)("div",{className:"flex flex-wrap gap-2",children:(a.participantsNames||a.participants).map((a,c)=>(0,b.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:a},c))})]}),a.notes&&(0,b.jsx)("div",{className:"mt-3 text-sm text-gray-600",children:(0,b.jsx)("p",{className:"line-clamp-2",children:a.notes})})]})};function m(){let a=(0,e.getAuth)(f.app),m=(0,d.useRouter)(),[n,o]=(0,c.useState)([]),[p,q]=(0,c.useState)([]),[r,s]=(0,c.useState)({}),[t,u]=(0,c.useState)(null),[v,w]=(0,c.useState)(null),[x,y]=(0,c.useState)(""),[z,A]=(0,c.useState)(!0),{t:B,language:C}=(0,j.useStrings)(),D=async a=>{try{for(let b of(await (0,g.getDocs)((0,g.collection)(f.db,"organizations"))).docs)if((await (0,g.getDoc)((0,g.doc)(f.db,`organizations/${b.id}/users/${a}`))).exists())return console.log("User found in organization:",b.id,b.data().name),b.id;return console.log("User not found in any organization"),null}catch(a){return console.error("Error fetching user organization:",a),null}},E=async a=>{try{let b=await (0,g.getDoc)((0,g.doc)(f.db,`organizations/${a}`));b.exists()&&y(b.data().name||"Organization")}catch(a){console.error("Error fetching organization data:",a)}},F=async a=>{try{let b=(0,g.collection)(f.db,`organizations/${a}/users`),c=await (0,g.getDocs)(b),d={};return c.forEach(a=>{d[a.id]=a.data().name||a.data().email}),s(d),d}catch(a){return console.error("Error fetching users:",a),{}}},G=async(a,b)=>{try{let c=await F(a),d=await (0,g.getDoc)((0,g.doc)(f.db,`organizations/${a}`)),e=d.exists()?d.data().name:"Organization",h=(0,g.collection)(f.db,`organizations/${a}/projects`),i=await (0,g.getDocs)(h);console.log(`Found ${i.docs.length} projects in organization`);let j=i.docs.map(a=>{let b=a.data();return{id:a.id,...b,organization:e,ownerName:c[b.createdBy||b.owner]||b.createdBy||b.owner,participantsNames:b.participants?.map(a=>c[a]||a)||[]}}).filter(a=>{let c=a.createdBy===b||a.owner===b,d=a.participants?.includes(b)||a.members?.includes(b);return console.log(`Project ${a.id}: isOwner=${c}, isParticipant=${d}`),c||d}).sort((a,b)=>{if("in progress"===a.status&&"in progress"!==b.status)return -1;if("in progress"!==a.status&&"in progress"===b.status)return 1;let c=new Date(a.createdAt||0);return new Date(b.createdAt||0)-c});console.log(`Filtered projects for user ${b}: ${j.length}`),o(j);let k=(0,g.collection)(f.db,`organizations/${a}/meetings`),l=await (0,g.getDocs)(k);console.log(`Found ${l.docs.length} meetings in organization`);let m=l.docs.map(a=>{let b=a.data();return{id:a.id,...b,ownerName:c[b.owner]||b.owner,participantsNames:b.participants?.map(a=>c[a]||a)||[]}}).filter(a=>{let c=a.owner===b,d=a.participants?.includes(b);return console.log(`Meeting ${a.id}: isOwner=${c}, isParticipant=${d}`),c||d}).sort((a,b)=>{let c=new Date(`${a.date} ${a.time||"00:00"}`),d=new Date(`${b.date} ${b.time||"00:00"}`);return c-d});console.log(`Filtered meetings for user ${b}: ${m.length}`),q(m)}catch(a){console.error("Error fetching data:",a)}finally{A(!1)}};(0,c.useEffect)(()=>{let b=(0,e.onAuthStateChanged)(a,async a=>{if(a){u(a);let b=await D(a.uid);b?(w(b),await E(b),await G(b,a.uid)):(console.error("User is not assigned to any organization"),A(!1),alert("You are not assigned to any organization. Please contact your administrator."))}else m.push("/auth/login")});return()=>b()},[]);let H=new Date().toLocaleDateString((()=>{switch(C){case"ru":return"ru-RU";case"en":default:return"en-GB";case"uz":return"uz-UZ"}})(),{day:"2-digit",month:"2-digit",year:"numeric",weekday:"long"});return z?(0,b.jsx)("div",{className:"flex items-center justify-center h-screen",children:(0,b.jsx)("div",{className:"text-xl",children:B("loading")})}):v?(0,b.jsxs)("div",{className:"flex",children:[(0,b.jsx)(h.default,{orgId:v}),(0,b.jsxs)("div",{className:"flex-1 ",children:[(0,b.jsx)(i.default,{orgId:v}),(0,b.jsxs)("div",{className:" p-6 bg-gray-50  min-h-screen",children:[(0,b.jsxs)("div",{className:"bg-linear-to-br from-green-600 to-green-400  rounded-xl p-6 mb-6 text-white",children:[(0,b.jsxs)("h1",{className:"text-3xl font-bold mb-2",children:[B("home.title"),", ",r[t?.uid]||t?.displayName||"User","!"]}),(0,b.jsxs)("div",{className:"flex items-center gap-2 text-blue-900",children:[(0,b.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),(0,b.jsx)("p",{className:"text-lg font-medium",children:x})]}),(0,b.jsxs)("div",{className:"mt-3",children:[(0,b.jsx)("p",{className:"text-sm text-blue-100",children:B("home.today")}),(0,b.jsx)("p",{className:"text-xl font-semibold text-white",children:H})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[(0,b.jsx)("div",{className:"bg-white  rounded-lg shadow-sm p-4 border border-gray-200",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-600",children:B("home.totalProjects")}),(0,b.jsx)("p",{className:"text-2xl font-bold text-gray-800",children:n.length})]}),(0,b.jsx)("div",{className:"bg-blue-100 rounded-full p-3",children:(0,b.jsx)("svg",{className:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})})})]})}),(0,b.jsx)("div",{className:"bg-white  rounded-lg shadow-sm p-4 border border-gray-200",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-600",children:B("home.upcomingMeetings")}),(0,b.jsx)("p",{className:"text-2xl font-bold text-gray-800",children:p.length})]}),(0,b.jsx)("div",{className:"bg-green-100 rounded-full p-3",children:(0,b.jsx)("svg",{className:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})})]})}),(0,b.jsx)("div",{className:"bg-white  rounded-lg shadow-sm p-4 border border-gray-200",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-600",children:B("home.teamMembers")}),(0,b.jsx)("p",{className:"text-2xl font-bold text-gray-800",children:Object.keys(r).length})]}),(0,b.jsx)("div",{className:"bg-purple-100 rounded-full p-3",children:(0,b.jsx)("svg",{className:"w-6 h-6 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})})]})})]}),(0,b.jsxs)("div",{className:"mb-8",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:B("projects.title")}),n.length>0&&(0,b.jsx)("a",{href:"/pages/projects",className:"text-blue-600 hover:text-blue-800 text-sm",children:B("home.viewAllProjects")})]}),0===n.length?(0,b.jsxs)("div",{className:"bg-white rounded-lg border-2 border-dashed border-gray-300 p-8 text-center",children:[(0,b.jsx)("svg",{className:"w-12 h-12 text-gray-400 mx-auto mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 13h6m-3-3v6m5 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),(0,b.jsx)("p",{className:"text-gray-500 mb-2",children:B("projects.noProjects")}),(0,b.jsx)("p",{className:"text-sm text-gray-400",children:B("projects.createNew")})]}):(0,b.jsx)("div",{className:"overflow-x-auto overflow-y-hidden",children:(0,b.jsx)("div",{className:"grid grid-cols-3 gap-4 pb-2",style:{width:"max-content"},children:n.map(a=>(0,b.jsx)("div",{style:{minWidth:"350px",maxWidth:"350px"},children:(0,b.jsx)(k,{project:a,orgId:v})},a.id))})})]}),(0,b.jsxs)("div",{className:"bg-green-100  rounded-xl p-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:B("meetings.title")}),p.length>0&&(0,b.jsx)("a",{href:"/pages/meetings",className:"text-blue-600 hover:text-blue-800 text-sm",children:B("home.viewAllMeetings")})]}),0===p.length?(0,b.jsxs)("div",{className:"bg-white rounded-lg border-2 border-dashed border-gray-300 p-8 text-center",children:[(0,b.jsx)("svg",{className:"w-12 h-12 text-gray-400 mx-auto mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),(0,b.jsx)("p",{className:"text-gray-500 mb-2",children:B("meetings.noMeetings")}),(0,b.jsx)("p",{className:"text-sm text-gray-400",children:B("meetings.scheduleFirst")})]}):(0,b.jsx)("div",{className:"overflow-x-auto overflow-y-hidden",children:(0,b.jsx)("div",{className:"grid grid-cols-3 gap-4 pb-2",style:{width:"max-content"},children:p.map(a=>(0,b.jsx)("div",{style:{minWidth:"320px",maxWidth:"320px"},children:(0,b.jsx)(l,{meeting:a,orgId:v})},a.id))})})]})]})]})]}):(0,b.jsx)("div",{className:"flex items-center justify-center h-screen bg-gray-50",children:(0,b.jsxs)("div",{className:"max-w-md w-full bg-white rounded-lg shadow-md p-8 text-center",children:[(0,b.jsx)("svg",{className:"w-16 h-16 text-yellow-500 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),(0,b.jsx)("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"No Organization"}),(0,b.jsx)("p",{className:"text-gray-600 mb-6",children:"You are not assigned to any organization. Please contact your administrator to get access."}),(0,b.jsx)("button",{onClick:()=>a.signOut(),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Sign Out"})]})})}a.s(["default",()=>m],19445)}];

//# sourceMappingURL=app_pages_homeScreen_page_c7a4263e.js.map
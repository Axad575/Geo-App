module.exports=[45548,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944);a.i(30485);var e=a.i(31052),f=a.i(76650);a.i(69387);var g=a.i(60574),h=a.i(84496),i=a.i(80858),j=a.i(10682),k=a.i(14705);let l=({isOpen:a,onClose:d,onSuccess:h,orgId:i,projectId:l=null})=>{let m=(0,e.getAuth)(f.app),{t:n}=(0,j.useStrings)(),[o,p]=(0,c.useState)([]),[q,r]=(0,c.useState)([]),[s,t]=(0,c.useState)(""),[u,v]=(0,c.useState)({title:"",date:"",location:"",createdBy:"",projectId:l||"",participants:[],description:"",status:"scheduled",type:"regular"}),w=async()=>{try{let a=(0,g.collection)(f.db,`organizations/${i}/users`),b=(await (0,g.getDocs)(a)).docs.map(a=>({id:a.id,...a.data()}));p(b)}catch(a){console.error("Error fetching users:",a)}},x=async()=>{try{let a=(0,g.collection)(f.db,`organizations/${i}/projects`),b=(await (0,g.getDocs)(a)).docs.map(a=>({id:a.id,...a.data()}));r(b)}catch(a){console.error("Error fetching projects:",a)}},y=async()=>{try{let a=await (0,g.getDoc)((0,g.doc)(f.db,`organizations/${i}`));a.exists()&&t(a.data().name||"Organization")}catch(a){console.error("Error fetching organization:",a)}};(0,c.useEffect)(()=>{if(a&&i){w(),x(),y();let a=m.currentUser;a&&v(b=>({...b,createdBy:a.uid,projectId:l||""}))}},[a,i,l]),(0,c.useEffect)(()=>(a?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[a]);let z=async a=>{a.preventDefault();try{let a={title:u.title,datetime:new Date(u.date).toISOString(),location:u.location||"",owner:u.createdBy,projectId:u.projectId||null,participants:u.participants,notes:u.description||"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},b=(0,g.collection)(f.db,`organizations/${i}/meetings`);await (0,g.addDoc)(b,a),h(),d(),v({title:"",date:"",location:"",createdBy:m.currentUser?.uid||"",projectId:l||"",participants:[],description:""})}catch(a){console.error("Error creating meeting:",a),alert("Error creating meeting. Please try again.")}};return a?(0,b.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4 overflow-y-auto",onClick:a=>{a.target===a.currentTarget&&d()},children:(0,b.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md max-h-full overflow-y-auto my-auto mx-auto shadow-xl",onClick:a=>a.stopPropagation(),children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold text-gray-900 ",children:n("meetings.scheduleMeeting")}),(0,b.jsx)("button",{onClick:d,className:"text-gray-500 hover:text-gray-700",children:(0,b.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),(0,b.jsxs)("form",{onSubmit:z,className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:n("projects.organization")}),(0,b.jsx)("input",{type:"text",value:s,disabled:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100 text-gray-600 cursor-not-allowed"})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[n("meetings.meetingTitle")," ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)("input",{type:"text",required:!0,value:u.title,onChange:a=>v(b=>({...b,title:a.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white text-gray-900",placeholder:n("meetings.meetingTitle")})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[n("meetings.startDate")," ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)("input",{type:"datetime-local",required:!0,value:u.date,onChange:a=>v(b=>({...b,date:a.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white text-gray-900"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:n("projects.projectOptional")}),(0,b.jsxs)("select",{value:u.projectId||"",onChange:a=>v(b=>({...b,projectId:a.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white text-gray-900",children:[(0,b.jsx)("option",{value:"",children:n("projects.noProject")}),q.map(a=>(0,b.jsx)("option",{value:a.id,children:a.title},a.id))]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:n("meetings.location")}),(0,b.jsx)("input",{type:"text",value:u.location,onChange:a=>v(b=>({...b,location:a.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white text-gray-900",placeholder:n("meetings.enterMeetingLocation")})]}),(0,b.jsx)(k.default,{users:o,selectedParticipants:u.participants,onParticipantsChange:a=>{v(b=>({...b,participants:a}))},excludeUserIds:u.createdBy?[u.createdBy]:[],label:n("meetings.participants"),placeholder:"ÐŸÐ¾Ð¸ÑÐº ÑƒÑ‡Ð°ÑÑ‚Ð½Ð¸ÐºÐ¾Ð² Ð¿Ð¾ Ð¸Ð¼ÐµÐ½Ð¸, email Ð¸Ð»Ð¸ Ñ€Ð¾Ð»Ð¸...",maxHeight:"200px",showSelectedCount:!0,className:"mb-4"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:n("meetings.notes")}),(0,b.jsx)("textarea",{value:u.description,onChange:a=>v(b=>({...b,description:a.target.value})),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white text-gray-900",placeholder:n("meetings.addMeetingNotes")})]}),(0,b.jsxs)("div",{className:"flex justify-end gap-3 mt-6",children:[(0,b.jsx)("button",{type:"button",onClick:d,className:"px-4 py-2 text-sm font-medium text-gray-700 hover:text-gray-900",children:n("meetings.cancel")}),(0,b.jsx)("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:n("meetings.createMeeting")})]})]})]})}):null};function m({meeting:a}){let{t:d}=(0,j.useStrings)(),[e,f]=(0,c.useState)(!1),g=b=>{if(console.log("Meeting object:",a),console.log("Meeting date:",a.date),console.log("Date type:",typeof a.date),!a.date)return void alert("ÐžÑˆÐ¸Ð±ÐºÐ°: Ð´Ð°Ñ‚Ð° Ð²ÑÑ‚Ñ€ÐµÑ‡Ð¸ Ð½Ðµ ÑƒÐºÐ°Ð·Ð°Ð½Ð°");try{let c=new Date(a.date);if(isNaN(c.getTime()))return void alert("ÐžÑˆÐ¸Ð±ÐºÐ°: Ð½ÐµÐ²ÐµÑ€Ð½Ñ‹Ð¹ Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚ Ð´Ð°Ñ‚Ñ‹ Ð²ÑÑ‚Ñ€ÐµÑ‡Ð¸");let d=(a=>{let b=((a,b="00:00")=>{try{let c=new Date(a),[d,e]=b.split(":");return c.setHours(parseInt(d)||0,parseInt(e)||0,0,0),c.toISOString().replace(/[-:]/g,"").split(".")[0]+"Z"}catch(a){return console.error("Error formatting date:",a),new Date().toISOString().replace(/[-:]/g,"").split(".")[0]+"Z"}})(a.date,a.time||"00:00"),c=new Date(a.date),[d,e]=(a.time||"00:00").split(":");c.setHours(parseInt(d)+1||1,parseInt(e)||0,0,0);let f=c.toISOString().replace(/[-:]/g,"").split(".")[0]+"Z",g=a.description||"Team meeting";a.conferenceUrl&&(g+=`

Ð¡ÑÑ‹Ð»ÐºÐ° Ð½Ð° ÐºÐ¾Ð½Ñ„ÐµÑ€ÐµÐ½Ñ†Ð¸ÑŽ: ${a.conferenceUrl}`);let h=new URL("https://calendar.google.com/calendar/render");h.searchParams.append("action","TEMPLATE"),h.searchParams.append("text",a.title),h.searchParams.append("dates",`${b}/${f}`),h.searchParams.append("details",g),h.searchParams.append("location",a.location||"Online");let i=new URL("https://outlook.live.com/calendar/0/deeplink/compose");return i.searchParams.append("subject",a.title),i.searchParams.append("body",g),i.searchParams.append("startdt",b),i.searchParams.append("enddt",f),i.searchParams.append("location",a.location||"Online"),{google:h.toString(),outlook:i.toString()}})(a);switch(b){case"google":window.open(d.google,"_blank");break;case"outlook":window.open(d.outlook,"_blank");break;case"apple":case"ics":(a=>{try{let b=((a,b="00:00")=>{let c=new Date(a),[d,e]=b.split(":");return c.setHours(parseInt(d)||0,parseInt(e)||0,0,0),c.toISOString().replace(/[-:]/g,"").split(".")[0]+"Z"})(a.date,a.time||"00:00"),c=new Date(a.date),[d,e]=(a.time||"00:00").split(":");c.setHours(parseInt(d)+1||1,parseInt(e)||0,0,0);let f=c.toISOString().replace(/[-:]/g,"").split(".")[0]+"Z",g=a.description||"Team meeting";a.conferenceUrl&&(g+=`\\nÐ¡ÑÑ‹Ð»ÐºÐ° Ð½Ð° ÐºÐ¾Ð½Ñ„ÐµÑ€ÐµÐ½Ñ†Ð¸ÑŽ: ${a.conferenceUrl}`);let h=`BEGIN:VCALENDAR
VERSION:2.0
PRODID:-//GeoNote//Meetings//EN
CALSCALE:GREGORIAN
METHOD:PUBLISH
BEGIN:VEVENT
UID:${a.id}@geonote.app
DTSTAMP:${new Date().toISOString().replace(/[-:]/g,"").split(".")[0]}Z
DTSTART:${b}
DTEND:${f}
SUMMARY:${a.title}
DESCRIPTION:${g.replace(/\n/g,"\\n")}
LOCATION:${a.location||"Online"}
STATUS:CONFIRMED
SEQUENCE:0
BEGIN:VALARM
TRIGGER:-PT15M
ACTION:DISPLAY
DESCRIPTION:ÐÐ°Ð¿Ð¾Ð¼Ð¸Ð½Ð°Ð½Ð¸Ðµ: ${a.title}
END:VALARM
END:VEVENT
END:VCALENDAR`,i=new Blob([h],{type:"text/calendar;charset=utf-8"}),j=document.createElement("a");j.href=window.URL.createObjectURL(i),j.download=`meeting-${a.id}.ics`,document.body.appendChild(j),j.click(),document.body.removeChild(j)}catch(a){throw console.error("Error creating ICS file:",a),a}})(a)}f(!1)}catch(a){console.error("Calendar action error:",a),alert("ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ñ€Ð¸ Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¸Ð¸ Ð² ÐºÐ°Ð»ÐµÐ½Ð´Ð°Ñ€ÑŒ")}};return(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsxs)("button",{onClick:()=>f(!e),className:"inline-flex items-center px-3 py-2 border border-gray-300     rounded-md shadow-sm bg-white text-sm font-medium    text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:[(0,b.jsx)("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),d("meetings.addToCalendar"),(0,b.jsx)("svg",{className:"w-4 h-4 ml-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})]}),e&&(0,b.jsx)("div",{className:"absolute right-0 mt-2 w-56 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 focus:outline-none z-10",children:(0,b.jsxs)("div",{className:"py-1",children:[(0,b.jsxs)("button",{onClick:()=>g("google"),className:"flex items-center w-full px-4 py-2 text-sm text-gray-700   hover:bg-gray-100 dark:hover:bg-gray-600",children:[(0,b.jsxs)("svg",{className:"w-4 h-4 mr-3",viewBox:"0 0 24 24",children:[(0,b.jsx)("path",{fill:"#4285f4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),(0,b.jsx)("path",{fill:"#34a853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),(0,b.jsx)("path",{fill:"#fbbc05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),(0,b.jsx)("path",{fill:"#ea4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),d("meetings.googleCalendar")]}),(0,b.jsxs)("button",{onClick:()=>g("outlook"),className:"flex items-center w-full px-4 py-2 text-sm text-gray-700   hover:bg-gray-100",children:[(0,b.jsx)("svg",{className:"w-4 h-4 mr-3",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{fill:"#0078d4",d:"M12 0C8.5 0 5.7 2.8 5.7 6.3v11.4C5.7 21.2 8.5 24 12 24s6.3-2.8 6.3-6.3V6.3C18.3 2.8 15.5 0 12 0zm3.6 13.8h-3.2v4.7c0 .4-.3.7-.7.7s-.7-.3-.7-.7v-4.7H7.8c-.4 0-.7-.3-.7-.7s.3-.7.7-.7H11v-2.8H7.8c-.4 0-.7-.3-.7-.7s.3-.7.7-.7H11V5.5c0-.4.3-.7.7-.7s.7.3.7.7v2.8h3.2c.4 0 .7.3.7.7s-.3.7-.7.7h-3.2v2.8h3.2c.4 0 .7.3.7.7s-.3.7-.7.7z"})}),d("meetings.outlookCalendar")]}),(0,b.jsxs)("button",{onClick:()=>g("apple"),className:"flex items-center w-full px-4 py-2 text-sm text-gray-700   hover:bg-gray-100",children:[(0,b.jsx)("svg",{className:"w-4 h-4 mr-3",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{fill:"currentColor",d:"M18.71 19.5c-.83 1.24-1.71 2.45-3.05 2.47-1.34.03-1.77-.79-3.29-.79-1.53 0-2 .77-3.27.82-1.31.05-2.3-1.32-3.14-2.53C4.25 17 2.94 12.45 4.7 9.39c.87-1.52 2.43-2.48 4.12-2.51 1.28-.02 2.5.87 3.29.87.78 0 2.26-1.07 3.81-.91.65.03 2.47.26 3.64 1.98-.09.06-2.17 1.28-2.15 3.81.03 3.02 2.65 4.03 2.68 4.04-.03.07-.42 1.44-1.38 2.83M13 3.5c.73-.83 1.94-1.46 2.94-1.5.13 1.17-.34 2.35-1.04 3.19-.69.85-1.83 1.51-2.95 1.42-.15-1.15.41-2.35 1.05-3.11z"})}),d("meetings.appleCalendar")]}),(0,b.jsx)("div",{className:"border-t border-gray-100"}),(0,b.jsxs)("button",{onClick:()=>g("ics"),className:"flex items-center w-full px-4 py-2 text-sm text-gray-700    hover:bg-gray-100",children:[(0,b.jsx)("svg",{className:"w-4 h-4 mr-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),d("meetings.downloadICS")]})]})})]})}let n=(a,b,c)=>{let d=`${b}_${a.replace(/[^a-zA-Z0-9]/g,"_")}_${c}`;return`https://meet.jit.si/${d}`},o=async(a,b,c)=>{try{for(let d of a.participants||[])await (0,g.addDoc)((0,g.collection)(c,`organizations/${b}/users/${d}/notifications`),{type:"meeting_started",meetingId:a.id,meetingTitle:a.title,conferenceUrl:a.conferenceUrl,createdAt:new Date().toISOString(),read:!1,message:`ÐÐ°Ñ‡Ð°Ð»Ð°ÑÑŒ Ð²ÑÑ‚Ñ€ÐµÑ‡Ð°: ${a.title}`})}catch(a){console.error("Error sending notifications:",a)}},p=({isOpen:a,onClose:d,onSubmit:h,orgId:i})=>{let{t:l}=(0,j.useStrings)(),[m,n]=(0,c.useState)({title:"",description:"",participants:[]}),[o,p]=(0,c.useState)([]),[q,r]=(0,c.useState)(!1),[s,t]=(0,c.useState)(null);(0,c.useEffect)(()=>{a&&i&&(u(),t((0,e.getAuth)().currentUser))},[a,i]);let u=async()=>{try{let a=(await (0,g.getDocs)((0,g.collection)(f.db,`organizations/${i}/users`))).docs.map(a=>({id:a.id,...a.data()}));p(a)}catch(a){console.error("Error fetching users:",a)}},v=async a=>{if(a.preventDefault(),m.title.trim()){r(!0);try{await h(m),n({title:"",description:"",participants:[]})}catch(a){console.error("Error creating quick meeting:",a)}finally{r(!1)}}};return a?(0,b.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,b.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold",children:l("meetings.instantMeeting")}),(0,b.jsx)("button",{onClick:d,className:"text-gray-400 hover:text-gray-600",children:(0,b.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),(0,b.jsxs)("form",{onSubmit:v,className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[l("meetings.meetingTopic")," *"]}),(0,b.jsx)("input",{type:"text",required:!0,value:m.title,onChange:a=>n(b=>({...b,title:a.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:l("meetings.enterMeetingTopic")})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:l("meetings.description")}),(0,b.jsx)("textarea",{value:m.description,onChange:a=>n(b=>({...b,description:a.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",rows:"3",placeholder:l("meetings.briefDescription")})]}),(0,b.jsx)(k.default,{users:o,selectedParticipants:m.participants,onParticipantsChange:a=>{n(b=>({...b,participants:a}))},excludeUserIds:s?[s.uid]:[],label:l("meetings.participantsLabel"),placeholder:l("meetings.searchParticipants"),maxHeight:"250px",showSelectedCount:!0}),(0,b.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,b.jsx)("button",{type:"submit",disabled:!m.title.trim()||q,className:"flex-1 bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-700 disabled:opacity-50 transition-colors flex items-center justify-center gap-2",children:q?l("meetings.starting"):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})}),l("meetings.startConference")]})}),(0,b.jsx)("button",{type:"button",onClick:d,disabled:q,className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 disabled:opacity-50 transition-colors",children:l("cancel")})]})]})]})}):null},q=({meeting:a,users:d,onMeetingUpdate:e})=>{let[f,g]=(0,c.useState)(!1),{t:h}=(0,j.useStrings)(),i=a=>{if(!a)return"";try{let b;if(b=a.seconds?new Date(1e3*a.seconds):"string"==typeof a||a instanceof String?new Date(a):a,isNaN(b.getTime()))return"";let c=String(b.getDate()).padStart(2,"0"),d=String(b.getMonth()+1).padStart(2,"0"),e=b.getFullYear();return`${c}/${d}/${e}`}catch(a){return console.error("Error formatting date:",a),""}},k=async()=>{g(!0);try{await e(a.id,{status:"completed",completedAt:new Date().toISOString()})}catch(a){console.error("Error marking meeting as completed:",a),alert(h("meetings.errorUpdating"))}finally{g(!1)}},l=async()=>{g(!0);try{if("instant"===a.type&&a.conferenceUrl)await e(a.id,{status:"in_progress",startedAt:new Date().toISOString()}),window.open(a.conferenceUrl,"_blank");else{let b=n(a.title,a.orgId,a.id);await e(a.id,{status:"in_progress",startedAt:new Date().toISOString(),conferenceUrl:b}),window.open(b,"_blank")}}catch(a){console.error("Error starting meeting:",a),alert(h("meetings.errorStarting"))}finally{g(!1)}},o=async()=>{if(window.confirm(h("meetings.cancelMeetingConfirm"))){g(!0);try{await e(a.id,{status:"cancelled",cancelledAt:new Date().toISOString()})}catch(a){console.error("Error cancelling meeting:",a),alert(h("meetings.errorCancelling"))}finally{g(!1)}}},p=a.status?.toLowerCase()||"scheduled",q="in_progress"===p,r="scheduled"===p||"upcoming"===p||!a.status||null===p;return(0,b.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-6 mb-4 hover:shadow-md transition-shadow",children:[(0,b.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("h3",{className:"text-xl font-semibold text-gray-900",children:a.title}),(0,b.jsx)("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${(a=>{switch(a?.toLowerCase()){case"completed":return"bg-green-100 text-green-800";case"in_progress":return"bg-blue-100 text-blue-800";case"scheduled":case"upcoming":case null:case void 0:return"bg-yellow-100 text-yellow-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}})(a.status)}`,children:(a=>{switch(a?.toLowerCase()){case"completed":return h("meetings.completed");case"in_progress":return h("meetings.inProgress");case"scheduled":case"upcoming":case null:case void 0:default:return h("meetings.scheduled");case"cancelled":return h("meetings.cancelled")}})(a.status)}),a.conferenceUrl&&(0,b.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-purple-100 text-purple-800",children:h("meetings.videoConference")})]}),(r||q)&&(0,b.jsx)(m,{meeting:{...a,date:a.datetime||new Date().toISOString()}})]}),(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm mb-3",children:[(0,b.jsxs)("div",{className:"text-gray-600",children:[(0,b.jsxs)("span",{className:"font-medium",children:[h("meetings.meetingDate"),":"]})," ",i(a.datetime)||h("meetings.noDate"),a.time&&` ${a.time}`]}),a.location&&(0,b.jsxs)("div",{className:"text-gray-600",children:[(0,b.jsxs)("span",{className:"font-medium",children:[h("meetings.location"),":"]})," ",a.location]}),a.completedAt&&(0,b.jsxs)("div",{className:"text-gray-600",children:[(0,b.jsxs)("span",{className:"font-medium",children:[h("meetings.finishedAt"),":"]})," ",i(a.completedAt)]}),a.startedAt&&(0,b.jsxs)("div",{className:"text-gray-600",children:[(0,b.jsxs)("span",{className:"font-medium",children:[h("meetings.startedAt"),":"]})," ",i(a.startedAt)]})]}),a.participants&&a.participants.length>0&&(0,b.jsxs)("div",{className:"mt-3",children:[(0,b.jsxs)("span",{className:"text-sm font-medium text-gray-700",children:[h("meetings.participants"),": "]}),(0,b.jsx)("div",{className:"flex flex-wrap gap-2 mt-1",children:a.participants.map(a=>(0,b.jsx)("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-xs",children:d[a]||a},a))})]})]}),"completed"===p?(0,b.jsxs)("div",{className:"flex items-center text-green-600 text-sm font-medium",children:[(0,b.jsx)("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}),h("meetings.completed")]}):"cancelled"===p?(0,b.jsxs)("div",{className:"flex items-center text-red-600 text-sm font-medium",children:[(0,b.jsx)("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})}),h("meetings.cancelled")]}):(0,b.jsxs)("div",{className:"flex gap-3",children:[r&&(0,b.jsxs)("button",{onClick:l,disabled:f,className:"px-4 py-2 bg-blue-600 text-white text-sm rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-colors flex items-center gap-1",children:[(0,b.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})}),f?"...":h("meetings.start")]}),q&&a.conferenceUrl&&(0,b.jsxs)("button",{onClick:()=>{a.conferenceUrl?window.open(a.conferenceUrl,"_blank"):alert(h("meetings.conferenceUrlUnavailable"))},className:"px-4 py-2 bg-purple-600 text-white text-sm rounded-lg hover:bg-purple-700 transition-colors flex items-center gap-1",children:[(0,b.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})}),h("meetings.join")]}),(0,b.jsxs)("button",{onClick:k,disabled:f,className:"px-4 py-2 bg-green-600 text-white text-sm rounded-lg hover:bg-green-700 disabled:opacity-50 transition-colors flex items-center gap-1",children:[(0,b.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}),f?"...":h("meetings.conducted")]}),(0,b.jsx)("button",{onClick:o,disabled:f,className:"px-4 py-2 bg-red-600 text-white text-sm rounded-lg hover:bg-red-700 disabled:opacity-50 transition-colors",children:f?"...":h("meetings.cancel")})]})]})};function r(){let a=(0,e.getAuth)(f.app),k=(0,d.useRouter)(),{t:m}=(0,j.useStrings)(),[r,s]=(0,c.useState)([]),[t,u]=(0,c.useState)(!0),[v,w]=(0,c.useState)(!1),[x,y]=(0,c.useState)(!1),[z,A]=(0,c.useState)({}),[B,C]=(0,c.useState)(null),[D,E]=(0,c.useState)(null),[F,G]=(0,c.useState)("all"),H=async a=>{try{for(let b of(await (0,g.getDocs)((0,g.collection)(f.db,"organizations"))).docs)if((await (0,g.getDoc)((0,g.doc)(f.db,`organizations/${b.id}/users/${a}`))).exists())return console.log("User found in organization:",b.id),b.id;return console.log("User not found in any organization"),null}catch(a){return console.error("Error fetching user organization:",a),null}},I=async a=>{try{let b=await (0,g.getDocs)((0,g.collection)(f.db,`organizations/${a}/users`)),c={};b.docs.forEach(a=>{c[a.id]=a.data().name||a.data().email}),A(c)}catch(a){console.error("Error fetching users:",a)}},J=async(a,b)=>{try{let c=(0,g.collection)(f.db,`organizations/${a}/meetings`),d=await (0,g.getDocs)(c);console.log(`Found ${d.docs.length} total meetings in organization`);let e=d.docs.map(b=>{let c=b.data();return console.log("Meeting data:",b.id,c),{id:b.id,orgId:a,...c}}).filter(a=>{let c=a.owner===b||a.createdBy===b,d=a.participants?.includes(b);return console.log(`Meeting "${a.title}": isOwner=${c}, isParticipant=${d}`),c||d}).sort((a,b)=>{let c=new Date(a.date?.seconds?1e3*a.date.seconds:a.date||0);return new Date(b.date?.seconds?1e3*b.date.seconds:b.date||0)-c});console.log(`Filtered ${e.length} meetings for user ${b}`),s(e)}catch(a){console.error("Error fetching meetings:",a)}finally{u(!1)}},K=async(a,b)=>{try{let c=(0,g.doc)(f.db,`organizations/${B}/meetings/${a}`);await (0,g.updateDoc)(c,{...b,updatedAt:new Date().toISOString()}),await J(B,D.uid)}catch(a){throw console.error("Error updating meeting:",a),a}},L=async a=>{try{let b=Date.now().toString(),c=n(a.title,B,b),d={...a,date:new Date().toISOString(),status:"in_progress",type:"instant",conferenceUrl:c,createdAt:new Date().toISOString(),createdBy:D.uid,startedAt:new Date().toISOString()},e=await (0,g.addDoc)((0,g.collection)(f.db,`organizations/${B}/meetings`),d),h=n(a.title,B,e.id);await (0,g.updateDoc)(e,{conferenceUrl:h}),window.open(h,"_blank"),await o({...d,id:e.id,conferenceUrl:h},B,f.db),await J(B,D.uid),y(!1)}catch(a){throw console.error("Error creating quick meeting:",a),a}};(0,c.useEffect)(()=>{let b=(0,e.onAuthStateChanged)(a,async a=>{if(a){E(a);let b=await H(a.uid);b?(C(b),await I(b),await J(b,a.uid)):(console.error("User is not assigned to any organization"),u(!1))}else k.push("/auth/login")});return()=>b()},[]);let M=r.filter(a=>{if("all"===F)return!0;let b=a.status?.toLowerCase()||"scheduled";return"scheduled"===F?"scheduled"===b||"upcoming"===b||!a.status||null===b:b===F}),N={total:r.length,scheduled:r.filter(a=>{let b=a.status?.toLowerCase()||"scheduled";return"scheduled"===b||"upcoming"===b||!a.status||null===b}).length,in_progress:r.filter(a=>a.status?.toLowerCase()==="in_progress").length,completed:r.filter(a=>a.status?.toLowerCase()==="completed").length,cancelled:r.filter(a=>a.status?.toLowerCase()==="cancelled").length};return(0,b.jsxs)("div",{className:"flex h-screen bg-gray-50",children:[(0,b.jsx)(h.default,{orgId:B}),(0,b.jsxs)("div",{className:"flex-1 flex flex-col",children:[(0,b.jsx)(i.default,{orgId:B}),(0,b.jsxs)("div",{className:"flex-1 p-8 overflow-auto",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:m("meetings.title")}),(0,b.jsxs)("div",{className:"flex gap-3",children:[(0,b.jsxs)("button",{onClick:()=>y(!0),className:"px-4 py-2 bg-green-600 text-white text-sm font-medium rounded-md hover:bg-green-700    focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 flex items-center gap-2",children:[(0,b.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})}),m("meetings.instantMeeting")]}),(0,b.jsxs)("button",{onClick:()=>w(!0),className:"px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-md hover:bg-blue-700    focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 flex items-center gap-2",children:[(0,b.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4v16m8-8H4"})}),m("meetings.scheduleMeeting")]})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-5 gap-4 mb-6",children:[(0,b.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:N.total}),(0,b.jsx)("div",{className:"text-sm text-gray-600",children:m("meetings.totalMeetings")})]}),(0,b.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-yellow-600",children:N.scheduled}),(0,b.jsx)("div",{className:"text-sm text-gray-600",children:m("meetings.scheduled")})]}),(0,b.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:N.in_progress}),(0,b.jsx)("div",{className:"text-sm text-gray-600",children:m("meetings.inProgress")})]}),(0,b.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-green-600",children:N.completed}),(0,b.jsx)("div",{className:"text-sm text-gray-600",children:m("meetings.completed")})]}),(0,b.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-red-600",children:N.cancelled}),(0,b.jsx)("div",{className:"text-sm text-gray-600",children:m("meetings.cancelled")})]})]}),(0,b.jsxs)("div",{className:"flex gap-2 mb-6",children:[(0,b.jsxs)("button",{onClick:()=>G("all"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${"all"===F?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-100"}`,children:[m("meetings.allMeetings")," (",N.total,")"]}),(0,b.jsxs)("button",{onClick:()=>G("scheduled"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${"scheduled"===F?"bg-yellow-600 text-white":"bg-white text-gray-700 hover:bg-gray-100"}`,children:[m("meetings.scheduled")," (",N.scheduled,")"]}),(0,b.jsxs)("button",{onClick:()=>G("in_progress"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${"in_progress"===F?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-100"}`,children:[m("meetings.inProgress")," (",N.in_progress,")"]}),(0,b.jsxs)("button",{onClick:()=>G("completed"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${"completed"===F?"bg-green-600 text-white":"bg-white text-gray-700 hover:bg-gray-100"}`,children:[m("meetings.completed")," (",N.completed,")"]}),(0,b.jsxs)("button",{onClick:()=>G("cancelled"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${"cancelled"===F?"bg-red-600 text-white":"bg-white text-gray-700 hover:bg-gray-100"}`,children:[m("meetings.cancelled")," (",N.cancelled,")"]})]}),t?(0,b.jsxs)("div",{className:"text-center text-gray-700",children:[m("meetings.loading"),"..."]}):0===M.length?(0,b.jsxs)("div",{className:"text-center py-12",children:[(0,b.jsx)("div",{className:"text-6xl mb-4",children:"ðŸ“¹"}),(0,b.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:m("all"===F?"meetings.noMeetingsYet":"scheduled"===F?"meetings.noScheduledMeetings":"in_progress"===F?"meetings.noCurrentMeetings":"completed"===F?"meetings.noCompletedMeetings":"meetings.noCancelledMeetings")}),(0,b.jsx)("p",{className:"text-gray-600 mb-4",children:m("all"===F?"meetings.scheduleOrStartMeeting":"meetings.tryChangeFilter")}),"all"===F&&(0,b.jsxs)("div",{className:"flex gap-3 justify-center",children:[(0,b.jsxs)("button",{onClick:()=>y(!0),className:"bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 transition-colors flex items-center gap-2",children:[(0,b.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})}),m("meetings.instantMeeting")]}),(0,b.jsx)("button",{onClick:()=>w(!0),className:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors",children:m("meetings.scheduleMeeting")})]})]}):(0,b.jsx)("div",{className:"max-w-4xl",children:M.map(a=>(0,b.jsx)(q,{meeting:a,users:z,onMeetingUpdate:K},a.id))})]}),B&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(l,{isOpen:v,onClose:()=>w(!1),onSuccess:()=>{B&&D&&J(B,D.uid)},orgId:B}),(0,b.jsx)(p,{isOpen:x,onClose:()=>y(!1),onSubmit:L,orgId:B})]})]})]})}a.s(["default",()=>r],45548)}];

//# sourceMappingURL=app_pages_meetings_page_e34ab4b6.js.map
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,77690,78698,e=>{"use strict";var t=e.i(43476),s=e.i(18566),r=e.i(35428);function a(){let e=(0,s.useRouter)(),{t:a}=(0,r.useStrings)();return(0,t.jsxs)("div",{className:"sticky top-2 w-56 h-screen bg-green-800 text-white flex flex-col justify-between rounded-lg shadow-lg m-2 shrink-0 z-10",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"p-4 text-2xl font-semibold",children:"Geo-Note"}),(0,t.jsxs)("div",{className:"flex flex-col space-y-4 mt-4 px-4",children:[(0,t.jsx)("button",{onClick:t=>{t.preventDefault(),console.log("Projects button clicked"),e.push("/pages/projects")},className:"bg-green-400 text-black py-2 rounded-md hover:bg-green-300 transition",children:a("nav.projects")}),(0,t.jsx)("button",{onClick:t=>{t.preventDefault(),console.log("News button clicked"),e.push("/pages/news")},className:"bg-green-400 text-black py-2 rounded-md hover:bg-green-300 transition",children:a("nav.news")}),(0,t.jsx)("button",{onClick:t=>{t.preventDefault(),console.log("Meetings button clicked"),e.push("/pages/meetings")},className:"bg-green-400 text-black py-2 rounded-md hover:bg-green-300 transition",children:a("nav.meetings")}),(0,t.jsx)("button",{onClick:t=>{t.preventDefault(),console.log("Notes button clicked"),e.push("/pages/notes")},className:"bg-green-400 text-black py-2 rounded-md hover:bg-green-300 transition",children:a("nav.notes")})]})]}),(0,t.jsxs)("div",{className:"p-4 text-xs text-gray-200",children:[(0,t.jsx)("div",{className:"flex flex-col space-y-4 mt-4 px-4 mb-4",children:(0,t.jsx)("button",{onClick:t=>{t.preventDefault(),console.log("Tickets button clicked"),e.push("/pages/tickets")},className:"bg-green-400 text-black py-2 rounded-md hover:bg-green-300 transition",children:a("nav.tickets")})}),(0,t.jsx)("p",{children:"Made by abdu1axad and dantajd"}),(0,t.jsx)("p",{children:"Copyright 2025"})]})]})}e.s(["default",()=>a],77690);var l=e.i(71645);function i(){let{t:e,language:a}=(0,r.useStrings)(),[i,n]=(0,l.useState)(e("navbar.determining")),[o,c]=(0,l.useState)(!1),d=(0,s.useRouter)();(0,l.useEffect)(()=>{"geolocation"in navigator?navigator.geolocation.getCurrentPosition(e=>{let{latitude:t,longitude:s}=e.coords;n(`${t.toFixed(5)}, ${s.toFixed(5)}`)},t=>{console.error(t),n(e("navbar.geolocationError"))}):n(e("navbar.geolocationUnavailable"))},[e]);let x=e=>{(0,r.changeLanguage)(e),c(!1)};return(0,t.jsxs)("div",{className:"flex items-center justify-between bg-green-900 text-white p-6 rounded-xl shadow-md m-2",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("span",{className:"material-symbols-outlined text-lg",children:"location_on"}),(0,t.jsx)("span",{className:"text-sm",children:i})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-6",children:[(0,t.jsx)("span",{className:"material-symbols-outlined text-lg cursor-pointer hover:text-green-300 transition",onClick:()=>d.push("/pages/homeScreen"),children:"home"}),(0,t.jsx)("span",{className:"material-symbols-outlined text-lg cursor-pointer hover:text-green-300 transition",onClick:()=>d.push("/pages/settings"),children:"settings"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsxs)("button",{onClick:()=>c(!o),className:"flex items-center space-x-1 cursor-pointer hover:text-green-300 transition text-sm font-medium",children:[(0,t.jsx)("span",{children:(()=>{switch(a){case"ru":return"RU";case"en":default:return"EN";case"uz":return"UZ"}})()}),(0,t.jsx)("svg",{className:`w-4 h-4 transition-transform ${o?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})]}),o&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"fixed inset-0 z-10",onClick:()=>c(!1)}),(0,t.jsxs)("div",{className:"absolute right-0 mt-2 w-40 bg-white rounded-lg shadow-lg z-20 overflow-hidden",children:[(0,t.jsxs)("button",{onClick:()=>x("ru"),className:`w-full px-4 py-3 text-left hover:bg-green-50 transition-colors flex items-center space-x-2 ${"ru"===a?"bg-green-50":""}`,children:[(0,t.jsx)("span",{className:"text-gray-800 font-medium",children:"Ð ÑƒÑÑÐºÐ¸Ð¹"}),"ru"===a&&(0,t.jsx)("svg",{className:"w-4 h-4 text-green-600 ml-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})})]}),(0,t.jsxs)("button",{onClick:()=>x("en"),className:`w-full px-4 py-3 text-left hover:bg-green-50 transition-colors flex items-center space-x-2 ${"en"===a?"bg-green-50":""}`,children:[(0,t.jsx)("span",{className:"text-gray-800 font-medium",children:"English"}),"en"===a&&(0,t.jsx)("svg",{className:"w-4 h-4 text-green-600 ml-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})})]}),(0,t.jsxs)("button",{onClick:()=>x("uz"),className:`w-full px-4 py-3 text-left hover:bg-green-50 transition-colors flex items-center space-x-2 ${"uz"===a?"bg-green-50":""}`,children:[(0,t.jsx)("span",{className:"text-gray-800 font-medium",children:"O'zbekcha"}),"uz"===a&&(0,t.jsx)("svg",{className:"w-4 h-4 text-green-600 ml-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})})]})]})]})]})]})]})}e.s(["default",()=>i],78698)},67493,e=>{"use strict";var t=e.i(43476),s=e.i(71645),r=e.i(35428);e.s(["default",0,({users:e=[],selectedParticipants:a=[],onParticipantsChange:l,excludeUserIds:i=[],maxHeight:n="200px",placeholder:o="",label:c="",showSelectedCount:d=!0,allowMultiple:x=!0,className:u=""})=>{let{t:p}=(0,r.useStrings)(),[m,g]=(0,s.useState)(""),[h,j]=(0,s.useState)(!1),b=o||p("participantSelector.searchPlaceholder"),f=c||p("participantSelector.participants"),v=(0,s.useMemo)(()=>e.filter(e=>!i.includes(e.id)).filter(e=>{if(!m.trim())return!0;let t=m.toLowerCase(),s=(e.name||"").toLowerCase(),r=(e.email||"").toLowerCase(),a=(e.role||"").toLowerCase();return s.includes(t)||r.includes(t)||a.includes(t)}).sort((e,t)=>{let s=a.includes(e.id),r=a.includes(t.id);if(s&&!r)return -1;if(!s&&r)return 1;let l=e.name||e.email||"",i=t.name||t.email||"";return l.localeCompare(i)}),[e,m,i,a]),y=e.filter(e=>a.includes(e.id));return(0,t.jsxs)("div",{className:`space-y-3 ${u}`,children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700",children:[f,d&&a.length>0&&(0,t.jsxs)("span",{className:"ml-2 text-blue-600 font-normal",children:["(",a.length," ",p("participantSelector.selected"),")"]})]}),a.length>0&&(0,t.jsx)("button",{type:"button",onClick:()=>{l([])},className:"text-sm text-red-600 hover:text-red-800",children:p("participantSelector.clearAll")})]}),(0,t.jsx)("div",{className:"relative",children:(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("input",{type:"text",value:m,onChange:e=>g(e.target.value),onFocus:()=>j(!0),placeholder:b,className:"w-full pl-10 pr-10 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),(0,t.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,t.jsx)("svg",{className:"h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),m&&(0,t.jsx)("button",{type:"button",onClick:()=>{g("")},className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:(0,t.jsx)("svg",{className:"h-5 w-5 text-gray-400 hover:text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]})}),y.length>0&&(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:y.map(e=>(0,t.jsxs)("div",{className:"flex items-center bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm",children:[(0,t.jsxs)("span",{className:"mr-2",children:[e.name||e.email,e.role&&(0,t.jsxs)("span",{className:"text-xs text-blue-600 ml-1",children:["(",e.role,")"]})]}),(0,t.jsx)("button",{type:"button",onClick:()=>{var t;return t=e.id,void l(a.filter(e=>e!==t))},className:"text-blue-600 hover:text-blue-800",children:(0,t.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]},e.id))}),(h||m)&&(0,t.jsx)("div",{className:"relative",children:(0,t.jsxs)("div",{className:"absolute top-0 left-0 right-0 bg-white border border-gray-300 rounded-lg shadow-lg z-10",style:{maxHeight:n},children:[(0,t.jsx)("div",{className:"overflow-y-auto p-2",style:{maxHeight:n},children:0===v.length?(0,t.jsx)("div",{className:"px-3 py-2 text-sm text-gray-500 text-center",children:p(m?"participantSelector.noParticipantsFound":"participantSelector.noAvailableParticipants")}):(0,t.jsx)("div",{className:"space-y-1",children:v.map(e=>{let s=a.includes(e.id);return(0,t.jsxs)("div",{onClick:()=>(e=>{if(!x){l([e]),j(!1);return}l(a.includes(e)?a.filter(t=>t!==e):[...a,e])})(e.id),className:`flex items-center p-2 rounded-md cursor-pointer transition-colors ${s?"bg-blue-50 border border-blue-200":"hover:bg-gray-50"}`,children:[(0,t.jsx)("input",{type:x?"checkbox":"radio",checked:s,onChange:()=>{},className:"mr-3 h-4 w-4 text-blue-600 rounded border-gray-300"}),(0,t.jsx)("div",{className:"flex-1 min-w-0",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-900 truncate",children:e.name||e.email||e.id}),e.email&&e.name&&(0,t.jsx)("p",{className:"text-xs text-gray-500 truncate",children:e.email})]}),e.role&&(0,t.jsx)("span",{className:"ml-2 px-2 py-1 text-xs bg-gray-100 text-gray-600 rounded-full",children:e.role})]})}),s&&(0,t.jsx)("svg",{className:"ml-2 h-4 w-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})})]},e.id)})})}),(0,t.jsx)("div",{className:"border-t border-gray-200 p-2",children:(0,t.jsx)("button",{type:"button",onClick:()=>j(!1),className:"w-full text-sm text-gray-600 hover:text-gray-800 py-1",children:p("participantSelector.collapse")})})]})}),m&&(0,t.jsxs)("div",{className:"text-xs text-gray-500",children:[p("participantSelector.found"),": ",v.length," ",p("participantSelector.of")," ",e.filter(e=>!i.includes(e.id)).length]}),(h||m)&&(0,t.jsx)("div",{className:"fixed inset-0 z-0",onClick:()=>{j(!1),g("")}})]})}])},38560,e=>{"use strict";var t=e.i(43476),s=e.i(71645),r=e.i(18566);e.i(51718);var a=e.i(18357),l=e.i(86632);e.i(36180);var i=e.i(98925),n=e.i(77690),o=e.i(78698),c=e.i(67493),d=e.i(35428);let x=(e,t)=>{if(!e)return"";try{let s=new Date(e);if(isNaN(s.getTime()))return t("projects.invalidDate");let r=String(s.getDate()).padStart(2,"0"),a=String(s.getMonth()+1).padStart(2,"0"),l=s.getFullYear();return`${r}/${a}/${l}`}catch(e){return console.error("Error formatting date:",e),t("projects.dateError")}},u=({isOpen:e,onClose:r,onSubmit:n,orgId:o})=>{let{t:x}=(0,d.useStrings)(),[u,p]=(0,s.useState)({title:"",description:"",startDate:"",endDate:"",status:"not started",priority:"medium",category:"",budget:"",participants:[]}),[m,g]=(0,s.useState)([]),[h,j]=(0,s.useState)(!1),[b,f]=(0,s.useState)(null);(0,s.useEffect)(()=>{e&&o&&(v(),f((0,a.getAuth)().currentUser))},[e,o]);let v=async()=>{try{let e=(await (0,i.getDocs)((0,i.collection)(l.db,`organizations/${o}/users`))).docs.map(e=>({id:e.id,...e.data()}));g(e)}catch(e){console.error("Error fetching users:",e)}},y=async e=>{if(e.preventDefault(),u.title.trim()){j(!0);try{await n(u),p({title:"",description:"",startDate:"",endDate:"",status:"not started",priority:"medium",category:"",budget:"",participants:[]}),r()}catch(e){console.error("Error creating project:",e)}finally{j(!1)}}},N=()=>{p({title:"",description:"",startDate:"",endDate:"",status:"not started",priority:"medium",category:"",budget:"",participants:[]}),r()};return e?(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,t.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold",children:x("projects.createNewProject")}),(0,t.jsx)("button",{onClick:N,className:"text-gray-400 hover:text-gray-600",children:(0,t.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),(0,t.jsxs)("form",{onSubmit:y,className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:x("projects.projectNameRequired")}),(0,t.jsx)("input",{type:"text",required:!0,value:u.title,onChange:e=>p(t=>({...t,title:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:x("projects.enterProjectName"),disabled:h})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:x("projects.description")}),(0,t.jsx)("textarea",{value:u.description,onChange:e=>p(t=>({...t,description:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",rows:"3",placeholder:x("projects.projectDescription"),disabled:h})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:x("projects.startDate")}),(0,t.jsx)("input",{type:"date",value:u.startDate,onChange:e=>p(t=>({...t,startDate:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:h})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:x("projects.endDate")}),(0,t.jsx)("input",{type:"date",value:u.endDate,onChange:e=>p(t=>({...t,endDate:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:h})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:x("projects.priority")}),(0,t.jsxs)("select",{value:u.priority,onChange:e=>p(t=>({...t,priority:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:h,children:[(0,t.jsx)("option",{value:"low",children:x("projects.lowPriority")}),(0,t.jsx)("option",{value:"medium",children:x("projects.mediumPriority")}),(0,t.jsx)("option",{value:"high",children:x("projects.highPriority")}),(0,t.jsx)("option",{value:"critical",children:x("projects.criticalPriority")})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:x("projects.category")}),(0,t.jsx)("input",{type:"text",value:u.category,onChange:e=>p(t=>({...t,category:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:x("projects.categoryPlaceholder"),disabled:h})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:x("projects.budget")}),(0,t.jsx)("input",{type:"text",value:u.budget,onChange:e=>p(t=>({...t,budget:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:x("projects.budgetPlaceholder"),disabled:h})]}),(0,t.jsx)(c.default,{users:m,selectedParticipants:u.participants,onParticipantsChange:e=>{p(t=>({...t,participants:e}))},excludeUserIds:b?[b.uid]:[],label:x("projects.projectParticipants"),placeholder:x("projects.searchParticipants"),maxHeight:"200px",showSelectedCount:!0,allowMultiple:!0,className:"w-full"}),(0,t.jsx)("div",{className:"text-xs text-gray-500",children:x("projects.creatorAutoAdded")}),(0,t.jsxs)("div",{className:"flex gap-3 pt-4 border-t",children:[(0,t.jsx)("button",{type:"submit",disabled:!u.title.trim()||h,className:"flex-1 bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:x(h?"projects.creating":"projects.createProject")}),(0,t.jsx)("button",{type:"button",onClick:N,disabled:h,className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 disabled:opacity-50 transition-colors",children:x("projects.cancel")})]})]})]})}):null},p=({project:e,onProjectUpdate:a})=>{let n=(0,r.useRouter)(),{t:o}=(0,d.useStrings)(),[c,u]=(0,s.useState)(!1),p=async t=>{u(!0);try{let s={status:t};"completed"===t&&(s.completedAt=new Date().toISOString(),s.completedBy=e.currentUserId),await (0,i.updateDoc)((0,i.doc)(l.db,`organizations/${e.orgId}/projects/${e.id}`),s),a&&a()}catch(e){console.error("Error updating project status:",e)}finally{u(!1)}},m=e.status?.toLowerCase()==="completed",g=e.status?.toLowerCase()==="not started"||e.status?.toLowerCase()==="upcoming";return(0,t.jsxs)("div",{className:`bg-white border-l-4 rounded-lg p-4 mb-3 shadow-sm hover:shadow-md transition-shadow ${(e=>{switch(e?.toLowerCase()){case"critical":return"bg-red-100 border-l-red-500";case"high":return"bg-orange-100 border-l-orange-500";case"medium":return"bg-yellow-100 border-l-yellow-500";case"low":return"bg-green-100 border-l-green-500";default:return"bg-gray-100 border-l-gray-500"}})(e.priority)}`,children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,t.jsx)("h4",{className:"font-semibold text-gray-900 text-sm leading-tight",children:e.title}),e.priority&&(0,t.jsx)("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${"critical"===e.priority?"bg-red-100 text-red-800":"high"===e.priority?"bg-orange-100 text-orange-800":"medium"===e.priority?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:(e=>{switch(e?.toLowerCase()){case"critical":return o("projects.critical");case"high":return o("projects.high");case"medium":return o("projects.medium");case"low":return o("projects.low");default:return e}})(e.priority)})]}),e.description&&(0,t.jsx)("p",{className:"text-xs text-gray-600 mb-2 line-clamp-2",children:e.description}),(0,t.jsxs)("div",{className:"text-xs text-gray-500 mb-3",children:[x(e.startDate,o)," - ",x(e.endDate,o)]}),e.category&&(0,t.jsx)("div",{className:"mb-2",children:(0,t.jsx)("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-xs",children:e.category})}),e.participants&&e.participants.length>0&&(0,t.jsxs)("div",{className:"mb-3",children:[(0,t.jsxs)("p",{className:"text-xs text-gray-500 mb-1",children:[o("projects.participants"),":"]}),(0,t.jsxs)("div",{className:"flex -space-x-2",children:[e.participants.slice(0,3).map((e,s)=>(0,t.jsx)("div",{className:"w-6 h-6 bg-blue-500 rounded-full border-2 border-white flex items-center justify-center text-white text-xs",title:e,children:e.charAt(0).toUpperCase()},s)),e.participants.length>3&&(0,t.jsxs)("div",{className:"w-6 h-6 bg-gray-500 rounded-full border-2 border-white flex items-center justify-center text-white text-xs",children:["+",e.participants.length-3]})]})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("button",{onClick:()=>n.push(`/pages/projects/${e.id}`),className:"text-blue-600 text-xs hover:text-blue-800 transition-colors",children:o("projects.openProject")}),g?(0,t.jsx)("button",{onClick:()=>p("in progress"),disabled:c,className:"text-xs px-3 py-1 text-white bg-green-500 rounded hover:bg-green-600 disabled:opacity-50 transition-colors",children:c?"...":o("projects.start")}):m?(0,t.jsx)("span",{className:"text-xs px-3 py-1 bg-green-100 text-green-800 rounded",children:o("projects.completed")}):(0,t.jsx)("button",{onClick:()=>p("completed"),disabled:c,className:"text-xs px-3 py-1 text-white bg-green-500 rounded hover:bg-green-600 disabled:opacity-50 transition-colors",children:c?"...":o("projects.finish")})]})]})},m=({title:e,projects:s,count:r,onProjectUpdate:a})=>{let{t:l}=(0,d.useStrings)();return(0,t.jsxs)("div",{className:"flex-1 bg-gray-50 rounded-lg p-4",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-4 pb-3 border-b border-gray-200",children:[(0,t.jsx)("h3",{className:"font-semibold text-gray-800",children:e}),(0,t.jsx)("span",{className:"bg-white px-2 py-1 rounded-full text-sm font-medium text-gray-600",children:r})]}),(0,t.jsxs)("div",{className:"min-h-[500px]",children:[s.map(e=>(0,t.jsx)(p,{project:e,onProjectUpdate:a},e.id)),0===s.length&&(0,t.jsxs)("div",{className:"text-center text-gray-400 text-sm mt-12",children:[(0,t.jsx)("div",{className:"text-4xl mb-2",children:"ðŸ“‹"}),(0,t.jsx)("p",{children:l("projects.noProjects")})]})]})]})};function g(){let e=(0,a.getAuth)(l.app),c=(0,r.useRouter)(),{t:p}=(0,d.useStrings)(),[g,h]=(0,s.useState)([]),[j,b]=(0,s.useState)(!0),[f,v]=(0,s.useState)(null),[y,N]=(0,s.useState)(null),[w,k]=(0,s.useState)("kanban"),[C,L]=(0,s.useState)(!1),S=async e=>{try{for(let t of(await (0,i.getDocs)((0,i.collection)(l.db,"organizations"))).docs)if((await (0,i.getDoc)((0,i.doc)(l.db,`organizations/${t.id}/users/${e}`))).exists())return console.log("User found in organization:",t.id),t.id;return console.log("User not found in any organization"),null}catch(e){return console.error("Error fetching user organization:",e),null}},D=async(e,t)=>{try{let s=await (0,i.getDoc)((0,i.doc)(l.db,`organizations/${e}`)),r=s.exists()?s.data().name:"Organization",a=await (0,i.getDocs)((0,i.collection)(l.db,`organizations/${e}/projects`));console.log(`Found ${a.docs.length} total projects in organization`);let n=a.docs.map(s=>{let a=s.data();return{id:s.id,...a,organization:r,orgId:e,currentUserId:t}}).filter(e=>{let s=e.createdBy===t||e.owner===t,r=e.participants?.includes(t)||e.members?.includes(t);return console.log(`Project "${e.title}": isCreator=${s}, isParticipant=${r}`),s||r}).sort((e,t)=>"in progress"===e.status&&"in progress"!==t.status?-1:"in progress"!==e.status&&"in progress"===t.status?1:new Date(t.createdAt||0)-new Date(e.createdAt||0));console.log(`Filtered ${n.length} projects for user ${t}`),h(n)}catch(e){console.error("Error fetching projects:",e)}finally{b(!1)}},P=async e=>{try{let t={...e,participants:e.participants.includes(y.uid)?e.participants:[...e.participants,y.uid],createdAt:new Date().toISOString(),createdBy:y.uid,createdByName:y.displayName||y.email,updatedAt:new Date().toISOString(),tasks:[],locations:[]};await (0,i.addDoc)((0,i.collection)(l.db,`organizations/${f}/projects`),t),await D(f,y.uid)}catch(e){throw console.error("Error creating project:",e),e}},$=()=>{f&&y&&D(f,y.uid)},z={upcoming:g.filter(e=>e.status?.toLowerCase()==="not started"||e.status?.toLowerCase()==="upcoming"),"in progress":g.filter(e=>e.status?.toLowerCase()==="in progress"||e.status?.toLowerCase()==="active"),completed:g.filter(e=>e.status?.toLowerCase()==="completed")},M={total:g.length,upcoming:z.upcoming.length,inProgress:z["in progress"].length,completed:z.completed.length};return((0,s.useEffect)(()=>{let t=(0,a.onAuthStateChanged)(e,async e=>{if(e){N(e);let t=await S(e.uid);t?(v(t),await D(t,e.uid)):(console.error("User is not assigned to any organization"),b(!1))}else c.push("/auth/login")});return()=>t()},[]),j)?(0,t.jsxs)("div",{className:"flex h-screen bg-gray-50",children:[(0,t.jsx)(n.default,{orgId:f}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)(o.default,{orgId:f}),(0,t.jsx)("div",{className:"p-8",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,t.jsx)("p",{className:"mt-4 text-gray-600",children:p("projects.loadingProjects")})]})})]})]}):(0,t.jsxs)("div",{className:"flex h-screen bg-gray-50",children:[(0,t.jsx)(n.default,{orgId:f}),(0,t.jsxs)("div",{className:"flex-1 flex flex-col",children:[(0,t.jsx)(o.default,{orgId:f}),(0,t.jsxs)("div",{className:"flex-1 p-6 overflow-auto",children:[(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:p("projects.title")}),(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsxs)("button",{onClick:()=>L(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2",children:[(0,t.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4v16m8-8H4"})}),p("projects.createNew")]}),(0,t.jsxs)("div",{className:"flex bg-gray-200 rounded-lg p-1",children:[(0,t.jsx)("button",{onClick:()=>k("kanban"),className:`px-3 py-2 text-sm font-medium rounded-md transition-colors ${"kanban"===w?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:p("projects.kanban")}),(0,t.jsx)("button",{onClick:()=>k("list"),className:`px-3 py-2 text-sm font-medium rounded-md transition-colors ${"list"===w?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:p("projects.list")})]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-4 gap-6 mb-8",children:[(0,t.jsx)("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("div",{className:"p-2 bg-blue-100 rounded-lg",children:(0,t.jsx)("svg",{className:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),(0,t.jsxs)("div",{className:"ml-4",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:M.total}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:p("projects.totalProjects")})]})]})}),(0,t.jsx)("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("div",{className:"p-2 bg-gray-100 rounded-lg",children:(0,t.jsx)("svg",{className:"w-6 h-6 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,t.jsxs)("div",{className:"ml-4",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:M.upcoming}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:p("projects.upcomingProjects")})]})]})}),(0,t.jsx)("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("div",{className:"p-2 bg-yellow-100 rounded-lg",children:(0,t.jsx)("svg",{className:"w-6 h-6 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),(0,t.jsxs)("div",{className:"ml-4",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:M.inProgress}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:p("projects.inProgressProjects")})]})]})}),(0,t.jsx)("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("div",{className:"p-2 bg-green-100 rounded-lg",children:(0,t.jsx)("svg",{className:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,t.jsxs)("div",{className:"ml-4",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:M.completed}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:p("projects.completedProjects")})]})]})})]})]}),0===g.length?(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsx)("div",{className:"text-6xl mb-4",children:"ðŸ“‹"}),(0,t.jsx)("h3",{className:"text-xl font-medium text-gray-900 mb-2",children:p("projects.noProjectsYet")}),(0,t.jsx)("p",{className:"text-gray-600 mb-6",children:p("projects.createFirstProject")}),(0,t.jsx)("button",{onClick:()=>L(!0),className:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors",children:p("projects.createFirstProjectBtn")})]}):(0,t.jsxs)(t.Fragment,{children:["kanban"===w&&(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-6",children:[(0,t.jsx)(m,{title:p("projects.upcoming"),projects:z.upcoming,count:M.upcoming,onProjectUpdate:$}),(0,t.jsx)(m,{title:p("projects.inProgress"),projects:z["in progress"],count:M.inProgress,onProjectUpdate:$}),(0,t.jsx)(m,{title:p("projects.completedColumn"),projects:z.completed,count:M.completed,onProjectUpdate:$})]}),"list"===w&&(0,t.jsx)("div",{className:"space-y-4",children:g.map(e=>(0,t.jsx)("div",{className:"bg-white rounded-lg shadow-sm border p-6 hover:shadow-md transition-shadow",children:(0,t.jsxs)("div",{className:"flex justify-between items-start",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:e.title}),e.priority&&(0,t.jsx)("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${"critical"===e.priority?"bg-red-100 text-red-800":"high"===e.priority?"bg-orange-100 text-orange-800":"medium"===e.priority?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:"critical"===e.priority?p("projects.critical"):"high"===e.priority?p("projects.high"):"medium"===e.priority?p("projects.medium"):p("projects.low")})]}),(0,t.jsx)("p",{className:"text-gray-600 mb-3",children:e.description||p("projects.noDescriptionProvided")}),(0,t.jsxs)("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[(0,t.jsxs)("span",{children:[p("projects.statusLabel"),": ",(0,t.jsx)("strong",{children:e.status})]}),(0,t.jsxs)("span",{children:[p("projects.createdDate"),": ",x(e.createdAt,p)]}),e.startDate&&(0,t.jsxs)("span",{children:[p("projects.startDateLabel"),": ",x(e.startDate,p)]}),e.endDate&&(0,t.jsxs)("span",{children:[p("projects.endDateLabel"),": ",x(e.endDate,p)]})]})]}),(0,t.jsx)("button",{onClick:()=>c.push(`/pages/projects/${e.id}`),className:"text-blue-600 hover:text-blue-800 font-medium",children:p("projects.open")})]})},e.id))})]})]})]}),(0,t.jsx)(u,{isOpen:C,onClose:()=>L(!1),onSubmit:P,orgId:f})]})}e.s(["default",()=>g])}]);
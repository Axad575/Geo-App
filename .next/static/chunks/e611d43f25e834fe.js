(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,77690,78698,e=>{"use strict";var t=e.i(43476),s=e.i(18566),r=e.i(35428);function n(){let e=(0,s.useRouter)(),{t:n}=(0,r.useStrings)();return(0,t.jsxs)("div",{className:"sticky top-2 w-56 h-screen bg-green-800 text-white flex flex-col justify-between rounded-lg shadow-lg m-2 shrink-0 z-10",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"p-4 text-2xl font-semibold",children:"Geo-Note"}),(0,t.jsxs)("div",{className:"flex flex-col space-y-4 mt-4 px-4",children:[(0,t.jsx)("button",{onClick:t=>{t.preventDefault(),console.log("Projects button clicked"),e.push("/pages/projects")},className:"bg-green-400 text-black py-2 rounded-md hover:bg-green-300 transition",children:n("nav.projects")}),(0,t.jsx)("button",{onClick:t=>{t.preventDefault(),console.log("News button clicked"),e.push("/pages/news")},className:"bg-green-400 text-black py-2 rounded-md hover:bg-green-300 transition",children:n("nav.news")}),(0,t.jsx)("button",{onClick:t=>{t.preventDefault(),console.log("Meetings button clicked"),e.push("/pages/meetings")},className:"bg-green-400 text-black py-2 rounded-md hover:bg-green-300 transition",children:n("nav.meetings")}),(0,t.jsx)("button",{onClick:t=>{t.preventDefault(),console.log("Notes button clicked"),e.push("/pages/notes")},className:"bg-green-400 text-black py-2 rounded-md hover:bg-green-300 transition",children:n("nav.notes")})]})]}),(0,t.jsxs)("div",{className:"p-4 text-xs text-gray-200",children:[(0,t.jsx)("div",{className:"flex flex-col space-y-4 mt-4 px-4 mb-4",children:(0,t.jsx)("button",{onClick:t=>{t.preventDefault(),console.log("Tickets button clicked"),e.push("/pages/tickets")},className:"bg-green-400 text-black py-2 rounded-md hover:bg-green-300 transition",children:n("nav.tickets")})}),(0,t.jsx)("p",{children:"Made by abdu1axad and dantajd"}),(0,t.jsx)("p",{children:"Copyright 2025"})]})]})}e.s(["default",()=>n],77690);var a=e.i(71645);function l(){let{t:e,language:n}=(0,r.useStrings)(),[l,i]=(0,a.useState)(e("navbar.determining")),[o,c]=(0,a.useState)(!1),d=(0,s.useRouter)();(0,a.useEffect)(()=>{"geolocation"in navigator?navigator.geolocation.getCurrentPosition(e=>{let{latitude:t,longitude:s}=e.coords;i(`${t.toFixed(5)}, ${s.toFixed(5)}`)},t=>{console.error(t),i(e("navbar.geolocationError"))}):i(e("navbar.geolocationUnavailable"))},[e]);let g=e=>{(0,r.changeLanguage)(e),c(!1)};return(0,t.jsxs)("div",{className:"flex items-center justify-between bg-green-900 text-white p-6 rounded-xl shadow-md m-2",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("span",{className:"material-symbols-outlined text-lg",children:"location_on"}),(0,t.jsx)("span",{className:"text-sm",children:l})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-6",children:[(0,t.jsx)("span",{className:"material-symbols-outlined text-lg cursor-pointer hover:text-green-300 transition",onClick:()=>d.push("/pages/homeScreen"),children:"home"}),(0,t.jsx)("span",{className:"material-symbols-outlined text-lg cursor-pointer hover:text-green-300 transition",onClick:()=>d.push("/pages/settings"),children:"settings"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsxs)("button",{onClick:()=>c(!o),className:"flex items-center space-x-1 cursor-pointer hover:text-green-300 transition text-sm font-medium",children:[(0,t.jsx)("span",{children:(()=>{switch(n){case"ru":return"RU";case"en":default:return"EN";case"uz":return"UZ"}})()}),(0,t.jsx)("svg",{className:`w-4 h-4 transition-transform ${o?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})]}),o&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"fixed inset-0 z-10",onClick:()=>c(!1)}),(0,t.jsxs)("div",{className:"absolute right-0 mt-2 w-40 bg-white rounded-lg shadow-lg z-20 overflow-hidden",children:[(0,t.jsxs)("button",{onClick:()=>g("ru"),className:`w-full px-4 py-3 text-left hover:bg-green-50 transition-colors flex items-center space-x-2 ${"ru"===n?"bg-green-50":""}`,children:[(0,t.jsx)("span",{className:"text-gray-800 font-medium",children:"Ð ÑƒÑÑÐºÐ¸Ð¹"}),"ru"===n&&(0,t.jsx)("svg",{className:"w-4 h-4 text-green-600 ml-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})})]}),(0,t.jsxs)("button",{onClick:()=>g("en"),className:`w-full px-4 py-3 text-left hover:bg-green-50 transition-colors flex items-center space-x-2 ${"en"===n?"bg-green-50":""}`,children:[(0,t.jsx)("span",{className:"text-gray-800 font-medium",children:"English"}),"en"===n&&(0,t.jsx)("svg",{className:"w-4 h-4 text-green-600 ml-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})})]}),(0,t.jsxs)("button",{onClick:()=>g("uz"),className:`w-full px-4 py-3 text-left hover:bg-green-50 transition-colors flex items-center space-x-2 ${"uz"===n?"bg-green-50":""}`,children:[(0,t.jsx)("span",{className:"text-gray-800 font-medium",children:"O'zbekcha"}),"uz"===n&&(0,t.jsx)("svg",{className:"w-4 h-4 text-green-600 ml-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})})]})]})]})]})]})]})}e.s(["default",()=>l],78698)},67493,e=>{"use strict";var t=e.i(43476),s=e.i(71645),r=e.i(35428);e.s(["default",0,({users:e=[],selectedParticipants:n=[],onParticipantsChange:a,excludeUserIds:l=[],maxHeight:i="200px",placeholder:o="",label:c="",showSelectedCount:d=!0,allowMultiple:g=!0,className:u=""})=>{let{t:m}=(0,r.useStrings)(),[x,h]=(0,s.useState)(""),[p,f]=(0,s.useState)(!1),b=o||m("participantSelector.searchPlaceholder"),j=c||m("participantSelector.participants"),v=(0,s.useMemo)(()=>e.filter(e=>!l.includes(e.id)).filter(e=>{if(!x.trim())return!0;let t=x.toLowerCase(),s=(e.name||"").toLowerCase(),r=(e.email||"").toLowerCase(),n=(e.role||"").toLowerCase();return s.includes(t)||r.includes(t)||n.includes(t)}).sort((e,t)=>{let s=n.includes(e.id),r=n.includes(t.id);if(s&&!r)return -1;if(!s&&r)return 1;let a=e.name||e.email||"",l=t.name||t.email||"";return a.localeCompare(l)}),[e,x,l,n]),y=e.filter(e=>n.includes(e.id));return(0,t.jsxs)("div",{className:`space-y-3 ${u}`,children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700",children:[j,d&&n.length>0&&(0,t.jsxs)("span",{className:"ml-2 text-blue-600 font-normal",children:["(",n.length," ",m("participantSelector.selected"),")"]})]}),n.length>0&&(0,t.jsx)("button",{type:"button",onClick:()=>{a([])},className:"text-sm text-red-600 hover:text-red-800",children:m("participantSelector.clearAll")})]}),(0,t.jsx)("div",{className:"relative",children:(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("input",{type:"text",value:x,onChange:e=>h(e.target.value),onFocus:()=>f(!0),placeholder:b,className:"w-full pl-10 pr-10 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),(0,t.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,t.jsx)("svg",{className:"h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),x&&(0,t.jsx)("button",{type:"button",onClick:()=>{h("")},className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:(0,t.jsx)("svg",{className:"h-5 w-5 text-gray-400 hover:text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]})}),y.length>0&&(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:y.map(e=>(0,t.jsxs)("div",{className:"flex items-center bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm",children:[(0,t.jsxs)("span",{className:"mr-2",children:[e.name||e.email,e.role&&(0,t.jsxs)("span",{className:"text-xs text-blue-600 ml-1",children:["(",e.role,")"]})]}),(0,t.jsx)("button",{type:"button",onClick:()=>{var t;return t=e.id,void a(n.filter(e=>e!==t))},className:"text-blue-600 hover:text-blue-800",children:(0,t.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]},e.id))}),(p||x)&&(0,t.jsx)("div",{className:"relative",children:(0,t.jsxs)("div",{className:"absolute top-0 left-0 right-0 bg-white border border-gray-300 rounded-lg shadow-lg z-10",style:{maxHeight:i},children:[(0,t.jsx)("div",{className:"overflow-y-auto p-2",style:{maxHeight:i},children:0===v.length?(0,t.jsx)("div",{className:"px-3 py-2 text-sm text-gray-500 text-center",children:m(x?"participantSelector.noParticipantsFound":"participantSelector.noAvailableParticipants")}):(0,t.jsx)("div",{className:"space-y-1",children:v.map(e=>{let s=n.includes(e.id);return(0,t.jsxs)("div",{onClick:()=>(e=>{if(!g){a([e]),f(!1);return}a(n.includes(e)?n.filter(t=>t!==e):[...n,e])})(e.id),className:`flex items-center p-2 rounded-md cursor-pointer transition-colors ${s?"bg-blue-50 border border-blue-200":"hover:bg-gray-50"}`,children:[(0,t.jsx)("input",{type:g?"checkbox":"radio",checked:s,onChange:()=>{},className:"mr-3 h-4 w-4 text-blue-600 rounded border-gray-300"}),(0,t.jsx)("div",{className:"flex-1 min-w-0",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-900 truncate",children:e.name||e.email||e.id}),e.email&&e.name&&(0,t.jsx)("p",{className:"text-xs text-gray-500 truncate",children:e.email})]}),e.role&&(0,t.jsx)("span",{className:"ml-2 px-2 py-1 text-xs bg-gray-100 text-gray-600 rounded-full",children:e.role})]})}),s&&(0,t.jsx)("svg",{className:"ml-2 h-4 w-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})})]},e.id)})})}),(0,t.jsx)("div",{className:"border-t border-gray-200 p-2",children:(0,t.jsx)("button",{type:"button",onClick:()=>f(!1),className:"w-full text-sm text-gray-600 hover:text-gray-800 py-1",children:m("participantSelector.collapse")})})]})}),x&&(0,t.jsxs)("div",{className:"text-xs text-gray-500",children:[m("participantSelector.found"),": ",v.length," ",m("participantSelector.of")," ",e.filter(e=>!l.includes(e.id)).length]}),(p||x)&&(0,t.jsx)("div",{className:"fixed inset-0 z-0",onClick:()=>{f(!1),h("")}})]})}])},60430,e=>{"use strict";var t=e.i(43476),s=e.i(71645),r=e.i(18566);e.i(51718);var n=e.i(18357),a=e.i(86632);e.i(36180);var l=e.i(98925),i=e.i(77690),o=e.i(78698),c=e.i(35428),d=e.i(67493);let g=({isOpen:e,onClose:r,onSuccess:i,orgId:o,projectId:g=null})=>{let u=(0,n.getAuth)(a.app),{t:m}=(0,c.useStrings)(),[x,h]=(0,s.useState)([]),[p,f]=(0,s.useState)([]),[b,j]=(0,s.useState)(""),[v,y]=(0,s.useState)({title:"",date:"",location:"",createdBy:"",projectId:g||"",participants:[],description:"",status:"scheduled",type:"regular"}),w=async()=>{try{let e=(0,l.collection)(a.db,`organizations/${o}/users`),t=(await (0,l.getDocs)(e)).docs.map(e=>({id:e.id,...e.data()}));h(t)}catch(e){console.error("Error fetching users:",e)}},N=async()=>{try{let e=(0,l.collection)(a.db,`organizations/${o}/projects`),t=(await (0,l.getDocs)(e)).docs.map(e=>({id:e.id,...e.data()}));f(t)}catch(e){console.error("Error fetching projects:",e)}},k=async()=>{try{let e=await (0,l.getDoc)((0,l.doc)(a.db,`organizations/${o}`));e.exists()&&j(e.data().name||"Organization")}catch(e){console.error("Error fetching organization:",e)}};(0,s.useEffect)(()=>{if(e&&o){w(),N(),k();let e=u.currentUser;e&&y(t=>({...t,createdBy:e.uid,projectId:g||""}))}},[e,o,g]),(0,s.useEffect)(()=>(e?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[e]);let C=async e=>{e.preventDefault();try{let e={title:v.title,datetime:new Date(v.date).toISOString(),location:v.location||"",owner:v.createdBy,projectId:v.projectId||null,participants:v.participants,notes:v.description||"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},t=(0,l.collection)(a.db,`organizations/${o}/meetings`);await (0,l.addDoc)(t,e),i(),r(),y({title:"",date:"",location:"",createdBy:u.currentUser?.uid||"",projectId:g||"",participants:[],description:""})}catch(e){console.error("Error creating meeting:",e),alert("Error creating meeting. Please try again.")}};return e?(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4 overflow-y-auto",onClick:e=>{e.target===e.currentTarget&&r()},children:(0,t.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md max-h-full overflow-y-auto my-auto mx-auto shadow-xl",onClick:e=>e.stopPropagation(),children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold text-gray-900 ",children:m("meetings.scheduleMeeting")}),(0,t.jsx)("button",{onClick:r,className:"text-gray-500 hover:text-gray-700",children:(0,t.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),(0,t.jsxs)("form",{onSubmit:C,className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:m("projects.organization")}),(0,t.jsx)("input",{type:"text",value:b,disabled:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100 text-gray-600 cursor-not-allowed"})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[m("meetings.meetingTitle")," ",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsx)("input",{type:"text",required:!0,value:v.title,onChange:e=>y(t=>({...t,title:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white text-gray-900",placeholder:m("meetings.meetingTitle")})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[m("meetings.startDate")," ",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsx)("input",{type:"datetime-local",required:!0,value:v.date,onChange:e=>y(t=>({...t,date:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white text-gray-900"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:m("projects.projectOptional")}),(0,t.jsxs)("select",{value:v.projectId||"",onChange:e=>y(t=>({...t,projectId:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white text-gray-900",children:[(0,t.jsx)("option",{value:"",children:m("projects.noProject")}),p.map(e=>(0,t.jsx)("option",{value:e.id,children:e.title},e.id))]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:m("meetings.location")}),(0,t.jsx)("input",{type:"text",value:v.location,onChange:e=>y(t=>({...t,location:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white text-gray-900",placeholder:m("meetings.enterMeetingLocation")})]}),(0,t.jsx)(d.default,{users:x,selectedParticipants:v.participants,onParticipantsChange:e=>{y(t=>({...t,participants:e}))},excludeUserIds:v.createdBy?[v.createdBy]:[],label:m("meetings.participants"),placeholder:"ÐŸÐ¾Ð¸ÑÐº ÑƒÑ‡Ð°ÑÑ‚Ð½Ð¸ÐºÐ¾Ð² Ð¿Ð¾ Ð¸Ð¼ÐµÐ½Ð¸, email Ð¸Ð»Ð¸ Ñ€Ð¾Ð»Ð¸...",maxHeight:"200px",showSelectedCount:!0,className:"mb-4"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:m("meetings.notes")}),(0,t.jsx)("textarea",{value:v.description,onChange:e=>y(t=>({...t,description:e.target.value})),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white text-gray-900",placeholder:m("meetings.addMeetingNotes")})]}),(0,t.jsxs)("div",{className:"flex justify-end gap-3 mt-6",children:[(0,t.jsx)("button",{type:"button",onClick:r,className:"px-4 py-2 text-sm font-medium text-gray-700 hover:text-gray-900",children:m("meetings.cancel")}),(0,t.jsx)("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:m("meetings.createMeeting")})]})]})]})}):null};function u({meeting:e}){let{t:r}=(0,c.useStrings)(),[n,a]=(0,s.useState)(!1),l=t=>{if(console.log("Meeting object:",e),console.log("Meeting date:",e.date),console.log("Date type:",typeof e.date),!e.date)return void alert("ÐžÑˆÐ¸Ð±ÐºÐ°: Ð´Ð°Ñ‚Ð° Ð²ÑÑ‚Ñ€ÐµÑ‡Ð¸ Ð½Ðµ ÑƒÐºÐ°Ð·Ð°Ð½Ð°");try{let s=new Date(e.date);if(isNaN(s.getTime()))return void alert("ÐžÑˆÐ¸Ð±ÐºÐ°: Ð½ÐµÐ²ÐµÑ€Ð½Ñ‹Ð¹ Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚ Ð´Ð°Ñ‚Ñ‹ Ð²ÑÑ‚Ñ€ÐµÑ‡Ð¸");let n=(e=>{let t=((e,t="00:00")=>{try{let s=new Date(e),[r,n]=t.split(":");return s.setHours(parseInt(r)||0,parseInt(n)||0,0,0),s.toISOString().replace(/[-:]/g,"").split(".")[0]+"Z"}catch(e){return console.error("Error formatting date:",e),new Date().toISOString().replace(/[-:]/g,"").split(".")[0]+"Z"}})(e.date,e.time||"00:00"),s=new Date(e.date),[r,n]=(e.time||"00:00").split(":");s.setHours(parseInt(r)+1||1,parseInt(n)||0,0,0);let a=s.toISOString().replace(/[-:]/g,"").split(".")[0]+"Z",l=e.description||"Team meeting";e.conferenceUrl&&(l+=`

Ð¡ÑÑ‹Ð»ÐºÐ° Ð½Ð° ÐºÐ¾Ð½Ñ„ÐµÑ€ÐµÐ½Ñ†Ð¸ÑŽ: ${e.conferenceUrl}`);let i=new URL("https://calendar.google.com/calendar/render");i.searchParams.append("action","TEMPLATE"),i.searchParams.append("text",e.title),i.searchParams.append("dates",`${t}/${a}`),i.searchParams.append("details",l),i.searchParams.append("location",e.location||"Online");let o=new URL("https://outlook.live.com/calendar/0/deeplink/compose");return o.searchParams.append("subject",e.title),o.searchParams.append("body",l),o.searchParams.append("startdt",t),o.searchParams.append("enddt",a),o.searchParams.append("location",e.location||"Online"),{google:i.toString(),outlook:o.toString()}})(e);switch(t){case"google":window.open(n.google,"_blank");break;case"outlook":window.open(n.outlook,"_blank");break;case"apple":case"ics":(e=>{try{let t=((e,t="00:00")=>{let s=new Date(e),[r,n]=t.split(":");return s.setHours(parseInt(r)||0,parseInt(n)||0,0,0),s.toISOString().replace(/[-:]/g,"").split(".")[0]+"Z"})(e.date,e.time||"00:00"),s=new Date(e.date),[r,n]=(e.time||"00:00").split(":");s.setHours(parseInt(r)+1||1,parseInt(n)||0,0,0);let a=s.toISOString().replace(/[-:]/g,"").split(".")[0]+"Z",l=e.description||"Team meeting";e.conferenceUrl&&(l+=`\\nÐ¡ÑÑ‹Ð»ÐºÐ° Ð½Ð° ÐºÐ¾Ð½Ñ„ÐµÑ€ÐµÐ½Ñ†Ð¸ÑŽ: ${e.conferenceUrl}`);let i=`BEGIN:VCALENDAR
VERSION:2.0
PRODID:-//GeoNote//Meetings//EN
CALSCALE:GREGORIAN
METHOD:PUBLISH
BEGIN:VEVENT
UID:${e.id}@geonote.app
DTSTAMP:${new Date().toISOString().replace(/[-:]/g,"").split(".")[0]}Z
DTSTART:${t}
DTEND:${a}
SUMMARY:${e.title}
DESCRIPTION:${l.replace(/\n/g,"\\n")}
LOCATION:${e.location||"Online"}
STATUS:CONFIRMED
SEQUENCE:0
BEGIN:VALARM
TRIGGER:-PT15M
ACTION:DISPLAY
DESCRIPTION:ÐÐ°Ð¿Ð¾Ð¼Ð¸Ð½Ð°Ð½Ð¸Ðµ: ${e.title}
END:VALARM
END:VEVENT
END:VCALENDAR`,o=new Blob([i],{type:"text/calendar;charset=utf-8"}),c=document.createElement("a");c.href=window.URL.createObjectURL(o),c.download=`meeting-${e.id}.ics`,document.body.appendChild(c),c.click(),document.body.removeChild(c)}catch(e){throw console.error("Error creating ICS file:",e),e}})(e)}a(!1),alert(r("meetings.calendarAdded"))}catch(e){console.error("Calendar action error:",e),alert("ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ñ€Ð¸ Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¸Ð¸ Ð² ÐºÐ°Ð»ÐµÐ½Ð´Ð°Ñ€ÑŒ")}};return(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsxs)("button",{onClick:()=>a(!n),className:"inline-flex items-center px-3 py-2 border border-gray-300     rounded-md shadow-sm bg-white text-sm font-medium    text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:[(0,t.jsx)("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),r("meetings.addToCalendar"),(0,t.jsx)("svg",{className:"w-4 h-4 ml-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})]}),n&&(0,t.jsx)("div",{className:"absolute right-0 mt-2 w-56 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 focus:outline-none z-10",children:(0,t.jsxs)("div",{className:"py-1",children:[(0,t.jsxs)("button",{onClick:()=>l("google"),className:"flex items-center w-full px-4 py-2 text-sm text-gray-700   hover:bg-gray-100 dark:hover:bg-gray-600",children:[(0,t.jsxs)("svg",{className:"w-4 h-4 mr-3",viewBox:"0 0 24 24",children:[(0,t.jsx)("path",{fill:"#4285f4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),(0,t.jsx)("path",{fill:"#34a853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),(0,t.jsx)("path",{fill:"#fbbc05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),(0,t.jsx)("path",{fill:"#ea4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),r("meetings.googleCalendar")]}),(0,t.jsxs)("button",{onClick:()=>l("outlook"),className:"flex items-center w-full px-4 py-2 text-sm text-gray-700   hover:bg-gray-100",children:[(0,t.jsx)("svg",{className:"w-4 h-4 mr-3",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{fill:"#0078d4",d:"M12 0C8.5 0 5.7 2.8 5.7 6.3v11.4C5.7 21.2 8.5 24 12 24s6.3-2.8 6.3-6.3V6.3C18.3 2.8 15.5 0 12 0zm3.6 13.8h-3.2v4.7c0 .4-.3.7-.7.7s-.7-.3-.7-.7v-4.7H7.8c-.4 0-.7-.3-.7-.7s.3-.7.7-.7H11v-2.8H7.8c-.4 0-.7-.3-.7-.7s.3-.7.7-.7H11V5.5c0-.4.3-.7.7-.7s.7.3.7.7v2.8h3.2c.4 0 .7.3.7.7s-.3.7-.7.7h-3.2v2.8h3.2c.4 0 .7.3.7.7s-.3.7-.7.7z"})}),r("meetings.outlookCalendar")]}),(0,t.jsxs)("button",{onClick:()=>l("apple"),className:"flex items-center w-full px-4 py-2 text-sm text-gray-700   hover:bg-gray-100",children:[(0,t.jsx)("svg",{className:"w-4 h-4 mr-3",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{fill:"currentColor",d:"M18.71 19.5c-.83 1.24-1.71 2.45-3.05 2.47-1.34.03-1.77-.79-3.29-.79-1.53 0-2 .77-3.27.82-1.31.05-2.3-1.32-3.14-2.53C4.25 17 2.94 12.45 4.7 9.39c.87-1.52 2.43-2.48 4.12-2.51 1.28-.02 2.5.87 3.29.87.78 0 2.26-1.07 3.81-.91.65.03 2.47.26 3.64 1.98-.09.06-2.17 1.28-2.15 3.81.03 3.02 2.65 4.03 2.68 4.04-.03.07-.42 1.44-1.38 2.83M13 3.5c.73-.83 1.94-1.46 2.94-1.5.13 1.17-.34 2.35-1.04 3.19-.69.85-1.83 1.51-2.95 1.42-.15-1.15.41-2.35 1.05-3.11z"})}),r("meetings.appleCalendar")]}),(0,t.jsx)("div",{className:"border-t border-gray-100"}),(0,t.jsxs)("button",{onClick:()=>l("ics"),className:"flex items-center w-full px-4 py-2 text-sm text-gray-700    hover:bg-gray-100",children:[(0,t.jsx)("svg",{className:"w-4 h-4 mr-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),r("meetings.downloadICS")]})]})})]})}let m=(e,t,s)=>{let r=`${t}_${e.replace(/[^a-zA-Z0-9]/g,"_")}_${s}`;return`https://meet.jit.si/${r}`},x=async(e,t,s)=>{try{for(let r of e.participants||[])await (0,l.addDoc)((0,l.collection)(s,`organizations/${t}/users/${r}/notifications`),{type:"meeting_started",meetingId:e.id,meetingTitle:e.title,conferenceUrl:e.conferenceUrl,createdAt:new Date().toISOString(),read:!1,message:`ÐÐ°Ñ‡Ð°Ð»Ð°ÑÑŒ Ð²ÑÑ‚Ñ€ÐµÑ‡Ð°: ${e.title}`})}catch(e){console.error("Error sending notifications:",e)}},h=({isOpen:e,onClose:r,onSubmit:i,orgId:o})=>{let{t:g}=(0,c.useStrings)(),[u,m]=(0,s.useState)({title:"",description:"",participants:[]}),[x,h]=(0,s.useState)([]),[p,f]=(0,s.useState)(!1),[b,j]=(0,s.useState)(null);(0,s.useEffect)(()=>{e&&o&&(v(),j((0,n.getAuth)().currentUser))},[e,o]);let v=async()=>{try{let e=(await (0,l.getDocs)((0,l.collection)(a.db,`organizations/${o}/users`))).docs.map(e=>({id:e.id,...e.data()}));h(e)}catch(e){console.error("Error fetching users:",e)}},y=async e=>{if(e.preventDefault(),u.title.trim()){f(!0);try{await i(u),m({title:"",description:"",participants:[]})}catch(e){console.error("Error creating quick meeting:",e)}finally{f(!1)}}};return e?(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,t.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold",children:g("meetings.instantMeeting")}),(0,t.jsx)("button",{onClick:r,className:"text-gray-400 hover:text-gray-600",children:(0,t.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),(0,t.jsxs)("form",{onSubmit:y,className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[g("meetings.meetingTopic")," *"]}),(0,t.jsx)("input",{type:"text",required:!0,value:u.title,onChange:e=>m(t=>({...t,title:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:g("meetings.enterMeetingTopic")})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:g("meetings.description")}),(0,t.jsx)("textarea",{value:u.description,onChange:e=>m(t=>({...t,description:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",rows:"3",placeholder:g("meetings.briefDescription")})]}),(0,t.jsx)(d.default,{users:x,selectedParticipants:u.participants,onParticipantsChange:e=>{m(t=>({...t,participants:e}))},excludeUserIds:b?[b.uid]:[],label:g("meetings.participantsLabel"),placeholder:g("meetings.searchParticipants"),maxHeight:"250px",showSelectedCount:!0}),(0,t.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,t.jsx)("button",{type:"submit",disabled:!u.title.trim()||p,className:"flex-1 bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-700 disabled:opacity-50 transition-colors flex items-center justify-center gap-2",children:p?g("meetings.starting"):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})}),g("meetings.startConference")]})}),(0,t.jsx)("button",{type:"button",onClick:r,disabled:p,className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 disabled:opacity-50 transition-colors",children:g("cancel")})]})]})]})}):null},p=({meeting:e,users:r,onMeetingUpdate:n})=>{let[a,l]=(0,s.useState)(!1),{t:i}=(0,c.useStrings)(),o=e=>{if(!e)return"";try{let t;if(t=e.seconds?new Date(1e3*e.seconds):"string"==typeof e||e instanceof String?new Date(e):e,isNaN(t.getTime()))return"";let s=String(t.getDate()).padStart(2,"0"),r=String(t.getMonth()+1).padStart(2,"0"),n=t.getFullYear();return`${s}/${r}/${n}`}catch(e){return console.error("Error formatting date:",e),""}},d=async()=>{l(!0);try{await n(e.id,{status:"completed",completedAt:new Date().toISOString()})}catch(e){console.error("Error marking meeting as completed:",e),alert(i("meetings.errorUpdating"))}finally{l(!1)}},g=async()=>{l(!0);try{if("instant"===e.type&&e.conferenceUrl)await n(e.id,{status:"in_progress",startedAt:new Date().toISOString()}),window.open(e.conferenceUrl,"_blank");else{let t=m(e.title,e.orgId,e.id);await n(e.id,{status:"in_progress",startedAt:new Date().toISOString(),conferenceUrl:t}),window.open(t,"_blank")}}catch(e){console.error("Error starting meeting:",e),alert(i("meetings.errorStarting"))}finally{l(!1)}},x=async()=>{if(window.confirm(i("meetings.cancelMeetingConfirm"))){l(!0);try{await n(e.id,{status:"cancelled",cancelledAt:new Date().toISOString()})}catch(e){console.error("Error cancelling meeting:",e),alert(i("meetings.errorCancelling"))}finally{l(!1)}}},h=e.status?.toLowerCase()||"scheduled",p="in_progress"===h,f="scheduled"===h||"upcoming"===h||!e.status||null===h;return(0,t.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-6 mb-4 hover:shadow-md transition-shadow",children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("h3",{className:"text-xl font-semibold text-gray-900",children:e.title}),(0,t.jsx)("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${(e=>{switch(e?.toLowerCase()){case"completed":return"bg-green-100 text-green-800";case"in_progress":return"bg-blue-100 text-blue-800";case"scheduled":case"upcoming":case null:case void 0:return"bg-yellow-100 text-yellow-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}})(e.status)}`,children:(e=>{switch(e?.toLowerCase()){case"completed":return i("meetings.completed");case"in_progress":return i("meetings.inProgress");case"scheduled":case"upcoming":case null:case void 0:default:return i("meetings.scheduled");case"cancelled":return i("meetings.cancelled")}})(e.status)}),e.conferenceUrl&&(0,t.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-purple-100 text-purple-800",children:i("meetings.videoConference")})]}),(f||p)&&(0,t.jsx)(u,{meeting:{...e,date:e.datetime||new Date().toISOString()}})]}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm mb-3",children:[(0,t.jsxs)("div",{className:"text-gray-600",children:[(0,t.jsxs)("span",{className:"font-medium",children:[i("meetings.meetingDate"),":"]})," ",o(e.datetime)||i("meetings.noDate"),e.time&&` ${e.time}`]}),e.location&&(0,t.jsxs)("div",{className:"text-gray-600",children:[(0,t.jsxs)("span",{className:"font-medium",children:[i("meetings.location"),":"]})," ",e.location]}),e.completedAt&&(0,t.jsxs)("div",{className:"text-gray-600",children:[(0,t.jsxs)("span",{className:"font-medium",children:[i("meetings.finishedAt"),":"]})," ",o(e.completedAt)]}),e.startedAt&&(0,t.jsxs)("div",{className:"text-gray-600",children:[(0,t.jsxs)("span",{className:"font-medium",children:[i("meetings.startedAt"),":"]})," ",o(e.startedAt)]})]}),e.participants&&e.participants.length>0&&(0,t.jsxs)("div",{className:"mt-3",children:[(0,t.jsxs)("span",{className:"text-sm font-medium text-gray-700",children:[i("meetings.participants"),": "]}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2 mt-1",children:e.participants.map(e=>(0,t.jsx)("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-xs",children:r[e]||e},e))})]})]}),"completed"===h?(0,t.jsxs)("div",{className:"flex items-center text-green-600 text-sm font-medium",children:[(0,t.jsx)("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}),i("meetings.completed")]}):"cancelled"===h?(0,t.jsxs)("div",{className:"flex items-center text-red-600 text-sm font-medium",children:[(0,t.jsx)("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})}),i("meetings.cancelled")]}):(0,t.jsxs)("div",{className:"flex gap-3",children:[f&&(0,t.jsxs)("button",{onClick:g,disabled:a,className:"px-4 py-2 bg-blue-600 text-white text-sm rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-colors flex items-center gap-1",children:[(0,t.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})}),a?"...":i("meetings.start")]}),p&&e.conferenceUrl&&(0,t.jsxs)("button",{onClick:()=>{e.conferenceUrl?window.open(e.conferenceUrl,"_blank"):alert(i("meetings.conferenceUrlUnavailable"))},className:"px-4 py-2 bg-purple-600 text-white text-sm rounded-lg hover:bg-purple-700 transition-colors flex items-center gap-1",children:[(0,t.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})}),i("meetings.join")]}),(0,t.jsxs)("button",{onClick:d,disabled:a,className:"px-4 py-2 bg-green-600 text-white text-sm rounded-lg hover:bg-green-700 disabled:opacity-50 transition-colors flex items-center gap-1",children:[(0,t.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}),a?"...":i("meetings.conducted")]}),(0,t.jsx)("button",{onClick:x,disabled:a,className:"px-4 py-2 bg-red-600 text-white text-sm rounded-lg hover:bg-red-700 disabled:opacity-50 transition-colors",children:a?"...":i("meetings.cancel")})]})]})};function f(){let e=(0,n.getAuth)(a.app),d=(0,r.useRouter)(),{t:u}=(0,c.useStrings)(),[f,b]=(0,s.useState)([]),[j,v]=(0,s.useState)(!0),[y,w]=(0,s.useState)(!1),[N,k]=(0,s.useState)(!1),[C,S]=(0,s.useState)({}),[L,M]=(0,s.useState)(null),[D,I]=(0,s.useState)(null),[E,$]=(0,s.useState)("all"),A=async e=>{try{for(let t of(await (0,l.getDocs)((0,l.collection)(a.db,"organizations"))).docs)if((await (0,l.getDoc)((0,l.doc)(a.db,`organizations/${t.id}/users/${e}`))).exists())return console.log("User found in organization:",t.id),t.id;return console.log("User not found in any organization"),null}catch(e){return console.error("Error fetching user organization:",e),null}},z=async e=>{try{let t=await (0,l.getDocs)((0,l.collection)(a.db,`organizations/${e}/users`)),s={};t.docs.forEach(e=>{s[e.id]=e.data().name||e.data().email}),S(s)}catch(e){console.error("Error fetching users:",e)}},O=async(e,t)=>{try{let s=(0,l.collection)(a.db,`organizations/${e}/meetings`),r=await (0,l.getDocs)(s);console.log(`Found ${r.docs.length} total meetings in organization`);let n=r.docs.map(t=>{let s=t.data();return console.log("Meeting data:",t.id,s),{id:t.id,orgId:e,...s}}).filter(e=>{let s=e.owner===t||e.createdBy===t,r=e.participants?.includes(t);return console.log(`Meeting "${e.title}": isOwner=${s}, isParticipant=${r}`),s||r}).sort((e,t)=>{let s=new Date(e.date?.seconds?1e3*e.date.seconds:e.date||0);return new Date(t.date?.seconds?1e3*t.date.seconds:t.date||0)-s});console.log(`Filtered ${n.length} meetings for user ${t}`),b(n)}catch(e){console.error("Error fetching meetings:",e)}finally{v(!1)}},U=async(e,t)=>{try{let s=(0,l.doc)(a.db,`organizations/${L}/meetings/${e}`);await (0,l.updateDoc)(s,{...t,updatedAt:new Date().toISOString()}),await O(L,D.uid)}catch(e){throw console.error("Error updating meeting:",e),e}},B=async e=>{try{let t=Date.now().toString(),s=m(e.title,L,t),r={...e,date:new Date().toISOString(),status:"in_progress",type:"instant",conferenceUrl:s,createdAt:new Date().toISOString(),createdBy:D.uid,startedAt:new Date().toISOString()},n=await (0,l.addDoc)((0,l.collection)(a.db,`organizations/${L}/meetings`),r),i=m(e.title,L,n.id);await (0,l.updateDoc)(n,{conferenceUrl:i}),window.open(i,"_blank"),await x({...r,id:n.id,conferenceUrl:i},L,a.db),await O(L,D.uid),k(!1)}catch(e){throw console.error("Error creating quick meeting:",e),e}};(0,s.useEffect)(()=>{let t=(0,n.onAuthStateChanged)(e,async e=>{if(e){I(e);let t=await A(e.uid);t?(M(t),await z(t),await O(t,e.uid)):(console.error("User is not assigned to any organization"),v(!1))}else d.push("/auth/login")});return()=>t()},[]);let P=f.filter(e=>{if("all"===E)return!0;let t=e.status?.toLowerCase()||"scheduled";return"scheduled"===E?"scheduled"===t||"upcoming"===t||!e.status||null===t:t===E}),T={total:f.length,scheduled:f.filter(e=>{let t=e.status?.toLowerCase()||"scheduled";return"scheduled"===t||"upcoming"===t||!e.status||null===t}).length,in_progress:f.filter(e=>e.status?.toLowerCase()==="in_progress").length,completed:f.filter(e=>e.status?.toLowerCase()==="completed").length,cancelled:f.filter(e=>e.status?.toLowerCase()==="cancelled").length};return(0,t.jsxs)("div",{className:"flex h-screen bg-gray-50",children:[(0,t.jsx)(i.default,{orgId:L}),(0,t.jsxs)("div",{className:"flex-1 flex flex-col",children:[(0,t.jsx)(o.default,{orgId:L}),(0,t.jsxs)("div",{className:"flex-1 p-8 overflow-auto",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:u("meetings.title")}),(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsxs)("button",{onClick:()=>k(!0),className:"px-4 py-2 bg-green-600 text-white text-sm font-medium rounded-md hover:bg-green-700    focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 flex items-center gap-2",children:[(0,t.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})}),u("meetings.instantMeeting")]}),(0,t.jsxs)("button",{onClick:()=>w(!0),className:"px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-md hover:bg-blue-700    focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 flex items-center gap-2",children:[(0,t.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4v16m8-8H4"})}),u("meetings.scheduleMeeting")]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-5 gap-4 mb-6",children:[(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:T.total}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:u("meetings.totalMeetings")})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-yellow-600",children:T.scheduled}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:u("meetings.scheduled")})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:T.in_progress}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:u("meetings.inProgress")})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-green-600",children:T.completed}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:u("meetings.completed")})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-red-600",children:T.cancelled}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:u("meetings.cancelled")})]})]}),(0,t.jsxs)("div",{className:"flex gap-2 mb-6",children:[(0,t.jsxs)("button",{onClick:()=>$("all"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${"all"===E?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-100"}`,children:[u("meetings.allMeetings")," (",T.total,")"]}),(0,t.jsxs)("button",{onClick:()=>$("scheduled"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${"scheduled"===E?"bg-yellow-600 text-white":"bg-white text-gray-700 hover:bg-gray-100"}`,children:[u("meetings.scheduled")," (",T.scheduled,")"]}),(0,t.jsxs)("button",{onClick:()=>$("in_progress"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${"in_progress"===E?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-100"}`,children:[u("meetings.inProgress")," (",T.in_progress,")"]}),(0,t.jsxs)("button",{onClick:()=>$("completed"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${"completed"===E?"bg-green-600 text-white":"bg-white text-gray-700 hover:bg-gray-100"}`,children:[u("meetings.completed")," (",T.completed,")"]}),(0,t.jsxs)("button",{onClick:()=>$("cancelled"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${"cancelled"===E?"bg-red-600 text-white":"bg-white text-gray-700 hover:bg-gray-100"}`,children:[u("meetings.cancelled")," (",T.cancelled,")"]})]}),j?(0,t.jsxs)("div",{className:"text-center text-gray-700",children:[u("meetings.loading"),"..."]}):0===P.length?(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsx)("div",{className:"text-6xl mb-4",children:"ðŸ“¹"}),(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:u("all"===E?"meetings.noMeetingsYet":"scheduled"===E?"meetings.noScheduledMeetings":"in_progress"===E?"meetings.noCurrentMeetings":"completed"===E?"meetings.noCompletedMeetings":"meetings.noCancelledMeetings")}),(0,t.jsx)("p",{className:"text-gray-600 mb-4",children:u("all"===E?"meetings.scheduleOrStartMeeting":"meetings.tryChangeFilter")}),"all"===E&&(0,t.jsxs)("div",{className:"flex gap-3 justify-center",children:[(0,t.jsxs)("button",{onClick:()=>k(!0),className:"bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 transition-colors flex items-center gap-2",children:[(0,t.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})}),u("meetings.instantMeeting")]}),(0,t.jsx)("button",{onClick:()=>w(!0),className:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors",children:u("meetings.scheduleMeeting")})]})]}):(0,t.jsx)("div",{className:"max-w-4xl",children:P.map(e=>(0,t.jsx)(p,{meeting:e,users:C,onMeetingUpdate:U},e.id))})]}),L&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(g,{isOpen:y,onClose:()=>w(!1),onSuccess:()=>{L&&D&&O(L,D.uid)},orgId:L}),(0,t.jsx)(h,{isOpen:N,onClose:()=>k(!1),onSubmit:B,orgId:L})]})]})]})}e.s(["default",()=>f],60430)}]);
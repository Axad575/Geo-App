(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,77690,78698,e=>{"use strict";var t=e.i(43476),r=e.i(18566),s=e.i(35428);function n(){let e=(0,r.useRouter)(),{t:n}=(0,s.useStrings)();return(0,t.jsxs)("div",{className:"sticky top-2 w-56 h-screen bg-green-800 text-white flex flex-col justify-between rounded-lg shadow-lg m-2 shrink-0 z-10",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"p-4 text-2xl font-semibold",children:"Geo-Note"}),(0,t.jsxs)("div",{className:"flex flex-col space-y-4 mt-4 px-4",children:[(0,t.jsx)("button",{onClick:t=>{t.preventDefault(),console.log("Projects button clicked"),e.push("/pages/projects")},className:"bg-green-400 text-black py-2 rounded-md hover:bg-green-300 transition",children:n("nav.projects")}),(0,t.jsx)("button",{onClick:t=>{t.preventDefault(),console.log("News button clicked"),e.push("/pages/news")},className:"bg-green-400 text-black py-2 rounded-md hover:bg-green-300 transition",children:n("nav.news")}),(0,t.jsx)("button",{onClick:t=>{t.preventDefault(),console.log("Meetings button clicked"),e.push("/pages/meetings")},className:"bg-green-400 text-black py-2 rounded-md hover:bg-green-300 transition",children:n("nav.meetings")}),(0,t.jsx)("button",{onClick:t=>{t.preventDefault(),console.log("Notes button clicked"),e.push("/pages/notes")},className:"bg-green-400 text-black py-2 rounded-md hover:bg-green-300 transition",children:n("nav.notes")})]})]}),(0,t.jsxs)("div",{className:"p-4 text-xs text-gray-200",children:[(0,t.jsx)("div",{className:"flex flex-col space-y-4 mt-4 px-4 mb-4",children:(0,t.jsx)("button",{onClick:t=>{t.preventDefault(),console.log("Tickets button clicked"),e.push("/pages/tickets")},className:"bg-green-400 text-black py-2 rounded-md hover:bg-green-300 transition",children:n("nav.tickets")})}),(0,t.jsx)("p",{children:"Made by abdu1axad and dantajd"}),(0,t.jsx)("p",{children:"Copyright 2025"})]})]})}e.s(["default",()=>n],77690);var a=e.i(71645);function i(){let{t:e,language:n}=(0,s.useStrings)(),[i,l]=(0,a.useState)(e("navbar.determining")),[o,d]=(0,a.useState)(!1),c=(0,r.useRouter)();(0,a.useEffect)(()=>{"geolocation"in navigator?navigator.geolocation.getCurrentPosition(e=>{let{latitude:t,longitude:r}=e.coords;l(`${t.toFixed(5)}, ${r.toFixed(5)}`)},t=>{console.error(t),l(e("navbar.geolocationError"))}):l(e("navbar.geolocationUnavailable"))},[e]);let u=e=>{(0,s.changeLanguage)(e),d(!1)};return(0,t.jsxs)("div",{className:"flex items-center justify-between bg-green-900 text-white p-6 rounded-xl shadow-md m-2",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("span",{className:"material-symbols-outlined text-lg",children:"location_on"}),(0,t.jsx)("span",{className:"text-sm",children:i})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-6",children:[(0,t.jsx)("span",{className:"material-symbols-outlined text-lg cursor-pointer hover:text-green-300 transition",onClick:()=>c.push("/pages/homeScreen"),children:"home"}),(0,t.jsx)("span",{className:"material-symbols-outlined text-lg cursor-pointer hover:text-green-300 transition",onClick:()=>c.push("/pages/settings"),children:"settings"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsxs)("button",{onClick:()=>d(!o),className:"flex items-center space-x-1 cursor-pointer hover:text-green-300 transition text-sm font-medium",children:[(0,t.jsx)("span",{children:(()=>{switch(n){case"ru":return"RU";case"en":default:return"EN";case"uz":return"UZ"}})()}),(0,t.jsx)("svg",{className:`w-4 h-4 transition-transform ${o?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})]}),o&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"fixed inset-0 z-10",onClick:()=>d(!1)}),(0,t.jsxs)("div",{className:"absolute right-0 mt-2 w-40 bg-white rounded-lg shadow-lg z-20 overflow-hidden",children:[(0,t.jsxs)("button",{onClick:()=>u("ru"),className:`w-full px-4 py-3 text-left hover:bg-green-50 transition-colors flex items-center space-x-2 ${"ru"===n?"bg-green-50":""}`,children:[(0,t.jsx)("span",{className:"text-gray-800 font-medium",children:"Русский"}),"ru"===n&&(0,t.jsx)("svg",{className:"w-4 h-4 text-green-600 ml-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})})]}),(0,t.jsxs)("button",{onClick:()=>u("en"),className:`w-full px-4 py-3 text-left hover:bg-green-50 transition-colors flex items-center space-x-2 ${"en"===n?"bg-green-50":""}`,children:[(0,t.jsx)("span",{className:"text-gray-800 font-medium",children:"English"}),"en"===n&&(0,t.jsx)("svg",{className:"w-4 h-4 text-green-600 ml-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})})]}),(0,t.jsxs)("button",{onClick:()=>u("uz"),className:`w-full px-4 py-3 text-left hover:bg-green-50 transition-colors flex items-center space-x-2 ${"uz"===n?"bg-green-50":""}`,children:[(0,t.jsx)("span",{className:"text-gray-800 font-medium",children:"O'zbekcha"}),"uz"===n&&(0,t.jsx)("svg",{className:"w-4 h-4 text-green-600 ml-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})})]})]})]})]})]})]})}e.s(["default",()=>i],78698)},91124,e=>{"use strict";var t=e.i(43476),r=e.i(71645),s=e.i(18566);e.i(51718);var n=e.i(18357),a=e.i(86632);e.i(36180);var i=e.i(98925),l=e.i(77690),o=e.i(78698),d=e.i(35428);let c=({news:e,onNewsUpdate:n,currentUserId:l,isAdmin:o})=>{(0,s.useRouter)();let{t:c}=(0,d.useStrings)(),[u,x]=(0,r.useState)(!1),g=async()=>{if(!(!l||e.readBy?.includes(l))){x(!0);try{let t=e.readBy||[];t.push(l),await (0,i.updateDoc)((0,i.doc)(a.db,`organizations/${e.orgId}/news/${e.id}`),{readBy:t,lastReadAt:new Date().toISOString()}),n&&n()}catch(e){console.error("Error marking news as read:",e)}finally{x(!1)}}},h=async()=>{if(o&&confirm(c("news.confirmArchive"))){x(!0);try{await (0,i.updateDoc)((0,i.doc)(a.db,`organizations/${e.orgId}/news/${e.id}`),{archived:!0,archivedAt:new Date().toISOString(),archivedBy:l}),n&&n()}catch(e){console.error("Error archiving news:",e)}finally{x(!1)}}},m=e.readBy?.includes(l);return(0,t.jsx)("div",{className:`rounded-lg border-2 mb-4 ${(e=>{switch(e?.toLowerCase()){case"high":return"border-red-400 bg-red-50";case"medium":return"border-yellow-400 bg-yellow-50";case"low":return"border-green-400 bg-green-50";default:return"border-gray-300 bg-white"}})(e.priority)} ${!m?"shadow-md":""}`,children:(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsx)("div",{className:"flex justify-between items-start mb-4",children:(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,t.jsxs)("h3",{className:`text-xl font-semibold ${!m?"text-gray-900":"text-gray-600"}`,children:[e.title,!m&&(0,t.jsx)("span",{className:"ml-2 w-2 h-2 bg-blue-500 rounded-full inline-block"})]}),(0,t.jsx)("span",{className:`px-2 py-1 rounded text-xs font-medium ${(e=>{switch(e?.toLowerCase()){case"high":return"bg-red-100 text-red-800";case"medium":return"bg-yellow-100 text-yellow-800";case"low":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}})(e.priority)}`,children:e.priority||"normal"})]}),(0,t.jsxs)("p",{className:"text-sm text-gray-600 mb-3",children:[(e=>{if(!e)return"";try{return new Date(e).toLocaleDateString("ru-RU",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}catch(t){return e}})(e.createdAt)," • ",e.authorName||c("news.authorUnknown")]}),(0,t.jsx)("p",{className:`${!m?"text-gray-900":"text-gray-600"} mb-4`,children:e.content}),e.tags&&e.tags.length>0&&(0,t.jsx)("div",{className:"flex flex-wrap gap-2 mb-4",children:e.tags.map((e,r)=>(0,t.jsxs)("span",{className:"bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded",children:["#",e]},r))})]})}),(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsxs)("div",{className:"flex gap-3",children:[!m&&(0,t.jsx)("button",{onClick:g,disabled:u,className:`px-4 py-2 text-sm font-medium rounded-md transition-colors ${u?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"}`,children:u?c("news.marking"):c("news.markAsRead")}),m&&(0,t.jsxs)("div",{className:"flex items-center text-green-600 text-sm",children:[(0,t.jsx)("svg",{className:"w-4 h-4 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),c("news.readStatus")]}),o&&!e.archived&&(0,t.jsx)("button",{onClick:h,disabled:u,className:"px-4 py-2 text-sm font-medium text-gray-600 hover:text-red-600 transition-colors",children:c("news.archiveButton")})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsxs)("p",{className:"text-xs text-gray-500",children:[c("news.readBy"),": ",e.readBy?.length||0," ",c("news.people")]}),e.archived&&(0,t.jsx)("span",{className:"text-xs bg-gray-100 text-gray-600 px-2 py-1 rounded",children:c("news.archivedStatus")})]})]})]})})};function u(){let e=(0,n.getAuth)(a.app),u=(0,s.useRouter)(),{t:x}=(0,d.useStrings)(),[g,h]=(0,r.useState)([]),[m,b]=(0,r.useState)(!0),[p,v]=(0,r.useState)(null),[w,y]=(0,r.useState)(null),[f,j]=(0,r.useState)(!1),[N,k]=(0,r.useState)("all"),[C,S]=(0,r.useState)(!1),[B,$]=(0,r.useState)({title:"",content:"",priority:"medium",tags:""}),z=async e=>{try{for(let t of(await (0,i.getDocs)((0,i.collection)(a.db,"organizations"))).docs){let r=await (0,i.getDoc)((0,i.doc)(a.db,`organizations/${t.id}/users/${e}`));if(r.exists()){let e=r.data();return j("admin"===e.role),t.id}}return null}catch(e){return console.error("Error fetching user organization:",e),null}},D=async(e,t)=>{try{let t=(await (0,i.getDocs)((0,i.collection)(a.db,`organizations/${e}/news`))).docs.map(t=>{let r=t.data();return{id:t.id,...r,orgId:e}}).sort((e,t)=>new Date(t.createdAt||0)-new Date(e.createdAt||0));h(t)}catch(e){console.error("Error fetching news:",e)}finally{b(!1)}},L=()=>{p&&w&&D(p,w.uid)},A=async e=>{if(e.preventDefault(),B.title.trim()&&B.content.trim())try{let e=B.tags.split(",").map(e=>e.trim()).filter(e=>e);await (0,i.addDoc)((0,i.collection)(a.db,`organizations/${p}/news`),{title:B.title,content:B.content,priority:B.priority,tags:e,createdAt:new Date().toISOString(),authorId:w.uid,authorName:w.displayName||w.email,readBy:[],archived:!1}),$({title:"",content:"",priority:"medium",tags:""}),S(!1),L()}catch(e){console.error("Error creating news:",e),alert(x("news.errorCreating"))}},R=g.filter(e=>"all"===N?!e.archived:"unread"===N?!e.archived&&!e.readBy?.includes(w?.uid):"read"===N?!e.archived&&e.readBy?.includes(w?.uid):"archived"!==N||e.archived),U={total:g.filter(e=>!e.archived).length,unread:g.filter(e=>!e.archived&&!e.readBy?.includes(w?.uid)).length,read:g.filter(e=>!e.archived&&e.readBy?.includes(w?.uid)).length,archived:g.filter(e=>e.archived).length};return((0,r.useEffect)(()=>{let t=(0,n.onAuthStateChanged)(e,async e=>{if(e){y(e);let t=await z(e.uid);t?(v(t),await D(t,e.uid)):(console.error("User is not assigned to any organization"),b(!1))}else u.push("/auth/login")});return()=>t()},[]),m)?(0,t.jsx)("div",{className:"flex items-center justify-center h-screen bg-gray-50",children:(0,t.jsx)("div",{className:"text-xl text-gray-700",children:x("loading")})}):(0,t.jsxs)("div",{className:"flex h-screen bg-gray-50",children:[(0,t.jsx)(l.default,{orgId:p}),(0,t.jsxs)("div",{className:"flex-1 flex flex-col",children:[(0,t.jsx)(o.default,{orgId:p}),(0,t.jsxs)("div",{className:"flex-1 p-8 overflow-auto",children:[(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:x("news.organizationNews")}),f&&(0,t.jsx)("button",{onClick:()=>S(!C),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:C?x("news.cancelButton"):x("news.addNewsButton")})]}),C&&f&&(0,t.jsxs)("div",{className:"bg-white rounded-lg border p-6 mb-6",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-4",children:x("news.createNews")}),(0,t.jsxs)("form",{onSubmit:A,children:[(0,t.jsx)("div",{className:"mb-4",children:(0,t.jsx)("input",{type:"text",placeholder:x("news.newsHeadline"),value:B.title,onChange:e=>$({...B,title:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})}),(0,t.jsx)("div",{className:"mb-4",children:(0,t.jsx)("textarea",{placeholder:x("news.newsContent"),value:B.content,onChange:e=>$({...B,content:e.target.value}),rows:"4",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})}),(0,t.jsxs)("div",{className:"mb-4 flex gap-4",children:[(0,t.jsxs)("select",{value:B.priority,onChange:e=>$({...B,priority:e.target.value}),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,t.jsx)("option",{value:"low",children:x("news.lowPriority")}),(0,t.jsx)("option",{value:"medium",children:x("news.mediumPriority")}),(0,t.jsx)("option",{value:"high",children:x("news.highPriority")})]}),(0,t.jsx)("input",{type:"text",placeholder:x("news.tagsPlaceholder"),value:B.tags,onChange:e=>$({...B,tags:e.target.value}),className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("button",{type:"submit",className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700",children:x("news.createButton")}),(0,t.jsx)("button",{type:"button",onClick:()=>S(!1),className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400",children:x("news.cancelFormButton")})]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[(0,t.jsxs)("div",{className:"bg-white rounded-lg border p-4",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:U.total}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:x("news.totalNews")})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg border p-4",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:U.unread}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:x("news.unread")})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg border p-4",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-green-600",children:U.read}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:x("news.read")})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg border p-4",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-gray-600",children:U.archived}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:x("news.archived")})]})]}),(0,t.jsxs)("div",{className:"flex gap-2 mb-4",children:[(0,t.jsxs)("button",{onClick:()=>k("all"),className:`px-4 py-2 text-sm font-medium rounded-md ${"all"===N?"bg-blue-600 text-white":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"}`,children:[x("news.all")," (",U.total,")"]}),(0,t.jsxs)("button",{onClick:()=>k("unread"),className:`px-4 py-2 text-sm font-medium rounded-md ${"unread"===N?"bg-blue-600 text-white":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"}`,children:[x("news.unreadFilter")," (",U.unread,")"]}),(0,t.jsxs)("button",{onClick:()=>k("read"),className:`px-4 py-2 text-sm font-medium rounded-md ${"read"===N?"bg-blue-600 text-white":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"}`,children:[x("news.readFilter")," (",U.read,")"]}),f&&(0,t.jsxs)("button",{onClick:()=>k("archived"),className:`px-4 py-2 text-sm font-medium rounded-md ${"archived"===N?"bg-blue-600 text-white":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"}`,children:[x("news.archive")," (",U.archived,")"]})]})]}),0===R.length?(0,t.jsxs)("div",{className:"text-center text-gray-500 py-12",children:[(0,t.jsx)("svg",{className:"w-16 h-16 mx-auto text-gray-400 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})}),(0,t.jsx)("p",{className:"text-xl font-semibold mb-2",children:x("news.noNewsMessage")}),(0,t.jsx)("p",{children:"all"===N?x("news.noNewsDescription"):"unread"===N?x("news.noUnreadNews"):"read"===N?x("news.noReadNews"):x("news.noArchivedNews")})]}):(0,t.jsx)("div",{className:"max-w-4xl",children:R.map(e=>(0,t.jsx)(c,{news:e,onNewsUpdate:L,currentUserId:w?.uid,isAdmin:f},e.id))})]})]})]})}e.s(["default",()=>u])}]);